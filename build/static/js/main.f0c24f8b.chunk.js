(this["webpackJsonpreact-edit-posterlens"]=this["webpackJsonpreact-edit-posterlens"]||[]).push([[0],{28:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return App}));var _Users_alvaroblancocobian_Sites_wp_wp_content_plugins_posterlens360_includes_react_edit_posterlens_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_AppDemoPosterlens__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(29),_AppEditPosterlens__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(31),_App_css__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(42),_App_css__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_App_css__WEBPACK_IMPORTED_MODULE_4__),bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(43),bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_5__);function App(){Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){console.log("THREE and PANOLENS: ".concat(window.PANOLENS),window.THREE),window.THREE=eval("THREE"),window.PANOLENS=eval("PANOLENS"),window.stopAllAnimations=window.stopAllAnimations}),[]);var isAppAsWidget=!!window.appAsWidget,isEditModeDefault="#edit"===window.location.hash||isAppAsWidget,_useState=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(isAppAsWidget),_useState2=Object(_Users_alvaroblancocobian_Sites_wp_wp_content_plugins_posterlens360_includes_react_edit_posterlens_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState,2),appAsWidget=_useState2[0],setAppAsWidget=_useState2[1],_useState3=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(isEditModeDefault?"edit":"demo"),_useState4=Object(_Users_alvaroblancocobian_Sites_wp_wp_content_plugins_posterlens360_includes_react_edit_posterlens_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState3,2),appMode=_useState4[0],setAppMode=_useState4[1],codeValidation=window.codeValidation,data=window.data;return"edit"===appMode?react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_AppEditPosterlens__WEBPACK_IMPORTED_MODULE_3__.a,{data:data,setAppMode:setAppMode,appAsWidget:appAsWidget,codeValidation:codeValidation}):react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_AppDemoPosterlens__WEBPACK_IMPORTED_MODULE_2__.a,{data:data,setAppMode:setAppMode,appAsWidget:appAsWidget})}},29:function(e,t,a){"use strict";var n=a(0),l=a.n(n);t.a=function(e){var t=e.data,a=e.setAppMode,r=e.appAsWidget;return Object(n.useEffect)((function(){console.log("hello from useEffect in App"),function(e){e?e:console.log("data variable not found.");var t=JSON.parse(localStorage.getItem("pl.o"));if(!(e=(null===t||void 0===t?void 0:t.worlds)?t:e))return void console.error("No data loaded. Cant initialize");window.plEditMode=!1,window.pl=document.querySelector("#posterlens-container").posterlens(e),window.pl.viewer.panorama.addEventListener("load",(function(e){console.log("\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89",e)})),window.scene=window.pl.viewer.getScene()}(t)}),[]),l.a.createElement("div",{className:"container"},l.a.createElement("h1",{onDoubleClick:function(){return a("edit")}},"Demo",r?l.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:function(){return a("edit")}},"Back"):null),l.a.createElement("div",{className:"posterlens-container",id:"posterlens-container"}))}},31:function(e,t,a){"use strict";a.d(t,"a",(function(){return V}));var n=a(8),l=a(21),r=a(13),o=a(12),c=a(6),i=a(0),s=a.n(i),p=a(9),u=a(1);var d=function(e){var t=Object(i.useState)(""),a=Object(c.a)(t,2),n=a[0],l=a[1],r=Object(i.useState)(!1),o=Object(c.a)(r,2),d=o[0],m=o[1];return Object(i.useEffect)((function(){if(d){l("Pick up an image in the screen");var t=function t(n){var r;if(null===(r=n.target)||void 0===r?void 0:r.src){var o=n.target.src;e.wrapperUpdateObjectSingleData(o),m(!1),document.removeEventListener("click",t,"pickupImg"),document.removeEventListener("keydown",a,"cancelPickup"),l("Image selected"),setTimeout((function(){return l("")}),3e3)}},a=function e(a){27===a.keyCode&&(m(!1),l("Cancelled"),setTimeout((function(){return l("")}),3e3),document.removeEventListener("click",t,"pickupImg"),document.removeEventListener("keydown",e,"cancelPickup"))};document.addEventListener("click",t,"pickupImg"),document.addEventListener("keydown",a,"cancelPickup")}}),[d]),s.a.createElement(u.a,{className:"input-group-"+e.input.option},s.a.createElement(u.a.Prepend,null,s.a.createElement(u.a.Text,null,e.input.label)),s.a.createElement(u.a.Append,{onClick:function(t){if(document.querySelector(".pl_selected_image")){var a=document.querySelector(".pl_selected_image");"IMG"===a.tagName?e.wrapperUpdateObjectSingleData(a.getAttribute("src")):a.getAttribute("data-url")&&e.wrapperUpdateObjectSingleData(a.getAttribute("data-url"))}else m(e.input.option)}},s.a.createElement(u.a.Text,null,d?"select an image":s.a.createElement(p.a,{variant:"primary"},"Pick image"))),s.a.createElement(u.a.Append,null,s.a.createElement(u.a.Text,null,e.getOptionsByObject3D(e.currentObject3D,e.input.option))),s.a.createElement("span",{className:"text-light bg-dark"},n))},m=a(24),b=a.n(m);function O(e){var t=e;return"number"===typeof t&&(t=t.toFixed(2)),t}function w(e,t){if(window.pl){var a=window.pl.viewer;if(a){var n=a.raycaster.intersectObject(a.panorama,!0);if(!(n.length<=0))for(var l=0;l<n.length;){if("invisibleWorld"===n[l].object.name){var r=n[l].point.clone(),o=a.panorama.getWorldPosition(new window.THREE.Vector3);r.sub(o);var c=[Math.round(r.x.toFixed(2)/2),Math.round(r.y.toFixed(2)/2),Math.round(r.z.toFixed(2)/2)];return t.setEditParams(Object.assign({},t.editParams,{currentMouse3DPosition:c})),c}l++}}else console.warn("Cant retrieve mouse pos, not viewer defined")}}function _(e){return["8a4a13b6c7ea2066b0aa6d72dd76c8e4"].includes(b.a.MD5(e).toString())}function j(e,t){t(Object(o.a)({},e));var a=JSON.stringify(e,!1,2);return localStorage.setItem("pl.o",a),window.onSavePlOptionsCallback&&window.onSavePlOptionsCallback(e),a}function f(e){var t=e.object3D,a=e.getOptionsByObject3D(t),n=Object(o.a)({},a);if(a)return n.pos=[O(t.position.x),O(t.position.y),O(t.position.z)],n.rot=[O(t.rotation.x),O(t.rotation.y),O(t.rotation.z)],n.scale=O(t.scale.x),j(e.plOptionsReplaceWorldParamsHotspot(t.name,n),e.setPlOptions),e.regenerate&&E(t,n,(function(t){e.selectObject(t)})),n;alert("error: no objectCP")}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0,l=n.getCurrentPanoramaParams(),r=l.hotspots.findIndex((function(t){return t.name===e}));if(!(r<0)){var o=l.hotspots.find((function(t){return t.name===e}));o=Object.assign({},o,t),Object.keys(o).forEach((function(e){return null===o[e]&&delete o[e]}));var c=n.plOptionsReplaceWorldParamsHotspot(e,o);j(c,n.setPlOptions);var i=window.pl.getObjectByName(e);a&&E(i,o,(function(e){n.selectObject(e)})),i&&t.hasOwnProperty("name")&&(i.name=t.name,n.setCurrentObject3D(i))}}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return!1;e.name;window.pl.viewer.panorama&&t?(window.pl.viewer.panorama.remove(e),t.creationCallback=a,window.pl.createNewObjectFromParams(window.pl.viewer.panorama,t)):a&&a(e)}var P=a(30),g=a(10),D=a(16);function y(e){var t,a=Object(i.useState)(""),l=Object(c.a)(a,2),r=l[0],o=l[1],m={getCurrentPanoramaParams:e.getCurrentPanoramaParams,plOptionsReplaceWorldParamsHotspot:e.plOptionsReplaceWorldParamsHotspot,setPlOptions:e.setPlOptions,selectObject:e.selectObject,setCurrentObject3D:e.setCurrentObject3D},b=function(t){var a=t===e.input.deleteIfValue?null:t,l=Object(n.a)({},e.input.option,a);"background"===e.input.option&&""===a&&(l[e.input.option]="transparent"),"sprite"===e.input.option&&!0===a&&(l.scale=10*e.currentObject3D.scale.x),"sprite"!==e.input.option||a||(l.scale=e.currentObject3D.scale.x/10);var r=!["name"].includes(e.input.option);console.log(m),v(e.currentObject3D.name,l,r,m),o("Applied!"),setTimeout((function(){return o("")}),1e3),e.selectObject(window.lastSelectedObj)};return s.a.createElement("div",{className:e.input.type+"-type "+(r?"editing ":"no-editing ")+(null!==(t=e.class)&&void 0!==t?t:""),id:"input-"+e.input.option,"sync-3d":["image"].includes(e.input.type)?"":e.input.option,"sync-default":e.input.deleteIfValue?"true":"false"}," ",function(){var t,a,l,c,i,O,w=e.getOptionsByObject3D(e.currentObject3D,e.input.option);switch(e.input.type){case"image-pick":return s.a.createElement(d,{input:e.input,currentObject3D:e.currentObject3D,getOptionsByObject3D:e.getOptionsByObject3D,wrapperUpdateObjectSingleData:b});case"image":return s.a.createElement(u.a,null,s.a.createElement(u.a.Prepend,null," ",s.a.createElement(u.a.Text,null,e.input.label)),s.a.createElement(P.FilePicker,{extensions:["jpg","jpeg","png","gif","svg"],dims:{minWidth:100,maxWidth:2500,minHeight:100,maxHeight:2500},onChange:function(t){return v(e.currentObject3D.name,Object(n.a)({},e.input.option,e.imgPath+t.name),!0,m)},onError:function(e){return alert(e)}},s.a.createElement(p.a,{variant:"primary"},"Select image")),s.a.createElement(p.a,{variant:"danger",onClick:function(e){b(null)}},"Clear"),s.a.createElement(u.a.Append,null," ",s.a.createElement(u.a.Text,null,w)));case"input":case"textarea":return s.a.createElement("form",{onSubmit:function(e){e.preventDefault(),b(e.currentTarget.querySelector("input").value)}},s.a.createElement(u.a,null,e.input.label?s.a.createElement(u.a.Prepend,null," ",s.a.createElement(u.a.Text,null,e.input.label)):null,s.a.createElement(g.a,{as:e.input.type,defaultValue:w,onChange:function(e){return o("Enter to save")},placeholder:null!==(t=e.input.placeholder)&&void 0!==t?t:" "}),s.a.createElement(u.a.Append,{onClick:function(t){return!!r&&b(t.currentTarget.closest("form").querySelector(e.input.type).value)}},s.a.createElement(u.a.Text,null," ",r||w," "))));case"number":return s.a.createElement("form",{onSubmit:function(e){e.preventDefault(),b(e.currentTarget.querySelector("input").value)}},s.a.createElement(u.a,null,e.input.label?s.a.createElement(u.a.Prepend,null," ",s.a.createElement(u.a.Text,null,e.input.label)):null,s.a.createElement(D.a.Check,{type:"number",step:null!==(a=e.input.step)&&void 0!==a?a:1,placeholder:null!==(l=e.input.placeholder)&&void 0!==l?l:" ",defaultValue:w,min:null!==(c=e.input.min)&&void 0!==c?c:0,max:null!==(i=e.input.max)&&void 0!==i?i:null,onChange:function(e){return o("Enter to save")}}),s.a.createElement(u.a.Append,{onClick:function(e){return!!r&&b(e.currentTarget.closest("form").querySelector("input").value)}},s.a.createElement(u.a.Text,null," ",r||w," "))));case"checkbox":return s.a.createElement(D.a.Group,null,s.a.createElement(D.a.Check,{type:"checkbox",label:e.input.label+"(".concat(w,")"),defaultChecked:w===e.input.checkedValue()||e.input.deleteIfValue===e.input.checkedValue(),onChange:function(t){var a=t.currentTarget.checked?e.input.checkedValue(e.currentObject3D):e.input.uncheckedValue(e.currentObject3D);b(a)}}));case"select":return s.a.createElement(u.a,null,s.a.createElement(u.a.Prepend,null," ",s.a.createElement(u.a.Text,null,e.input.label)),s.a.createElement(g.a,{as:"select",defaultValue:w,onChange:function(e){return b(e.target.value)}},s.a.createElement("option",{key:"nothing",value:""},"---"),"object"===typeof e.input.options?null===(O=Object.keys(e.input.options))||void 0===O?void 0:O.map((function(t){return s.a.createElement("option",{key:t,value:e.input.options[t]},t)})):null),s.a.createElement(u.a.Append,null,s.a.createElement(u.a.Text,null," ",w," ")," "));case"color":return s.a.createElement(u.a,{"sync-3d":e.input.option},s.a.createElement(u.a.Prepend,null," ",s.a.createElement(u.a.Text,null,e.input.label)),s.a.createElement("input",{type:"color",defaultValue:w||e.input.deleteIfValue,onChange:function(e){return b(e.target.value)}}),s.a.createElement(u.a.Append,null,s.a.createElement(u.a.Text,null," ",w," ")," "))}}())}var C=function(e){var t,a=Object(i.useRef)(null),n={getCurrentPanoramaParams:e.getCurrentPanoramaParams,plOptionsReplaceWorldParamsHotspot:e.plOptionsReplaceWorldParamsHotspot,setPlOptions:e.setPlOptions,selectObject:e.selectObject,setCurrentObject3D:e.setCurrentObject3D},l={};e.plOptions&&e.plOptions.worlds.forEach((function(e){return l[e.name]=e.name}));var r={};return(null===(t=window)||void 0===t?void 0:t.cardListCallback)&&(r=window.cardListCallback()),e.currentObject3D?s.a.createElement("div",null,s.a.createElement(u.a,{"sync-3d":"onClickAction"},s.a.createElement(u.a.Prepend,null," ",s.a.createElement(u.a.Text,null,"On click action")),s.a.createElement(g.a,{as:"select",defaultValue:e.getOptionsByObject3D(e.currentObject3D,"onClickAction"),onChange:function(t){return function(t){if(e.currentObject3D){e.setOnClickOption(t);var a={onClickAction:t};["pano","url",""].includes(t)&&(a.modal=null),["iframe","card",""].includes(t)&&(a.link=null),v(e.currentObject3D.name,a,!0,n)}}(t.target.value)},ref:a},s.a.createElement("option",{key:"nothing",value:""},"---"),s.a.createElement("option",{value:"pano"}," Link to panorama"),s.a.createElement("option",{value:"url"}," Link to URL"),s.a.createElement("option",{value:"iframe"}," iframe popup"),s.a.createElement("option",{value:"card"}," Card"))),e.onClickOption?s.a.createElement("div",null,s.a.createElement("div",null,e.onClickOption),"pano"===e.onClickOption?s.a.createElement(y,{input:{option:"link",type:"select",options:l,label:"PANORAMA",deleteIfValue:"",active:["pl_poster3d","pl_text-2d","pl_text-3d"]},currentObject3D:e.currentObject3D,getOptionsByObject3D:e.getOptionsByObject3D,getCurrentPanoramaParams:e.getCurrentPanoramaParams,plOptionsReplaceWorldParamsHotspot:e.plOptionsReplaceWorldParamsHotspot,setPlOptions:e.setPlOptions,selectObject:e.selectObject,setCurrentObject3D:e.setCurrentObject3D}):null,"url"===e.onClickOption?s.a.createElement("div",null,s.a.createElement(y,{input:{option:"link",type:"input",label:"url",deleteIfValue:"",active:["pl_poster3d","pl_text-2d","pl_text-3d"]},currentObject3D:e.currentObject3D,getOptionsByObject3D:e.getOptionsByObject3D,getCurrentPanoramaParams:e.getCurrentPanoramaParams,plOptionsReplaceWorldParamsHotspot:e.plOptionsReplaceWorldParamsHotspot,setPlOptions:e.setPlOptions,selectObject:e.selectObject,setCurrentObject3D:e.setCurrentObject3D})):null,"iframe"===e.onClickOption?s.a.createElement("div",null,s.a.createElement(y,{input:{option:"modal",type:"input",label:"iframe url",deleteIfValue:"",active:["pl_poster3d","pl_text-2d","pl_text-3d"]},currentObject3D:e.currentObject3D,getOptionsByObject3D:e.getOptionsByObject3D,getCurrentPanoramaParams:e.getCurrentPanoramaParams,plOptionsReplaceWorldParamsHotspot:e.plOptionsReplaceWorldParamsHotspot,setPlOptions:e.setPlOptions,selectObject:e.selectObject,setCurrentObject3D:e.setCurrentObject3D})):null,"card"===e.onClickOption?s.a.createElement("div",null,s.a.createElement(y,{input:{option:"modal",type:"select",options:r,label:"Modal Card",deleteIfValue:"",active:["pl_poster3d","pl_text-2d","pl_text-3d"]},currentObject3D:e.currentObject3D,getOptionsByObject3D:e.getOptionsByObject3D,getCurrentPanoramaParams:e.getCurrentPanoramaParams,plOptionsReplaceWorldParamsHotspot:e.plOptionsReplaceWorldParamsHotspot,setPlOptions:e.setPlOptions,selectObject:e.selectObject,setCurrentObject3D:e.setCurrentObject3D})):null):null):null};var k=function(e){var t,a,n,l=e.input,r=e.props;if(!r.currentObject3D)return null;function o(e){if(!r.currentObject3D)return null;if("distance"===e)return parseInt(window.pl.viewer.camera.position.distanceTo(r.currentObject3D.position));if("scale.x"===e)return parseInt(100*r.currentObject3D.scale.x)/100;var t=e.split("."),a=r.currentObject3D;return t.forEach((function(e){return a=a[e]})),a}var c=r.currentObject3D?o(l.prop):null;return s.a.createElement(u.a,{"sync-3d":l.field,className:null!==(t="input-group "+r.class)&&void 0!==t?t:""},s.a.createElement(u.a.Prepend,null," ",s.a.createElement(u.a.Text,null,l.label)),s.a.createElement(D.a.Control,{type:"range",id:l.prop,name:l.prop,className:"range-control",min:l.min,max:l.max,defaultValue:c,step:l.step,onChange:null!==(a=l.onChange)&&void 0!==a?a:function(e){!function(e,t){var a=parseInt(100*t)/100;if(!r.currentObject3D)return null;var n=e.split(".");1===n.length?r.currentObject3D[n[0]]=a:r.currentObject3D[n[0]][n[1]]=a}(l.prop,e.target.value)},onMouseUp:null!==(n=l.onMouseUp)&&void 0!==n?n:function(e){l.onChange&&l.onChange(e),f({object3D:r.currentObject3D,getOptionsByObject3D:r.getOptionsByObject3D,setPlOptions:r.setPlOptions,selectObject:r.selectObject,plOptionsReplaceWorldParamsHotspot:r.plOptionsReplaceWorldParamsHotspot})}}),s.a.createElement(u.a.Append,null," ",s.a.createElement(u.a.Text,null,o(l.prop))))};var h=function(e){var t,a={getCurrentPanoramaParams:e.getCurrentPanoramaParams,currentObject3D:e.currentObject3D,setCurrentObject3D:e.setCurrentObject3D,selectObject:e.selectObject,getOptionsByObject3D:e.getOptionsByObject3D,setPlOptions:e.setPlOptions,plOptionsReplaceWorldParamsHotspot:e.plOptionsReplaceWorldParamsHotspot,class:"col-4 flex-nowrap"};return s.a.createElement("div",{className:null!==(t=e.class)&&void 0!==t?t:"nothing"},s.a.createElement(k,{input:{label:"RotX",prop:"rotation.x",field:"rot.0",default:[],min:-Math.PI,max:Math.PI,step:.01},props:a}),s.a.createElement(k,{input:{label:"RotY",prop:"rotation.y",field:"rot.1",default:[],min:-Math.PI,max:Math.PI,step:.01},props:a}),s.a.createElement(k,{input:{label:"RotZ",prop:"rotation.z",field:"rot.2",default:[],min:-Math.PI,max:Math.PI,step:.01},props:a}),s.a.createElement(k,{input:{label:"Dist",prop:"distance",field:"distance",default:[],min:1,max:460,step:1,onChange:function(t){var a=e.currentObject3D.position.clone().normalize().multiplyScalar(t.target.value);window.pl.setObjectPos(e.currentObject3D,[a.x,a.y,a.z])}},props:a}),s.a.createElement(k,{input:{label:"Scale",prop:"scale.x",field:"scale",default:[],min:"pl_text-3d"===e.currentObject3D.type?.01:1,max:"pl_text-3d"===e.currentObject3D.type?3:e.currentObject3D.isSprite?400:100,step:"pl_text-3d"===e.currentObject3D.type?.01:1,onChange:function(t){return e.currentObject3D.scale.x=t.target.value,e.currentObject3D.scale.y=t.target.value,e.currentObject3D.scale.z=t.target.value,!1}},props:a}))},S=a(11);function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"close",a=1.02;"close"===t&&(a=1/a);var n=e.position.clone();n.x*=a,n.y*=a,n.z*=a;var l=window.pl.viewer.camera.position.distanceTo(n);"close"!==t&&l>500||"close"===t&&l<40?console.warn("we cant move that limit. Its out of 40 - 500m"):window.pl.setObjectPos(e,[n.x,n.y,n.z])}var A=function(e){function t(t,a){if(a){var n=w(0,{setEditParams:e.setEditParams,editParams:e.editParams});if(n){var o=Object(l.a)(window.THREE.Vector3,Object(r.a)(n)).normalize().multiplyScalar(a.distance);window.pl.setObjectPos(a,[o.x,o.y,o.z])}}}Object(i.useEffect)((function(){if(window.pl){var e=window.pl.viewer;e.renderer.domElement.addEventListener("mousedown",(function(e){a(e)})),e.renderer.domElement.addEventListener("mousemove",(function(e){t(0,window.selectedObj)})),e.renderer.domElement.addEventListener("mouseup",(function(e){n(e)})),e.renderer.domElement.addEventListener("dblclick",(function(e){window.lastSelectedObj&&t(0,window.lastSelectedObj)}))}}),[e.plOptions]);var a=function(t){var a;if(e.isEditMode&&!window.pl.shiftIsPressed){var n=window.pl.viewer,l=n.raycaster.intersectObject(n.panorama,!0),r=l[0]?l[0].object:null;r&&(null===(a=r.type)||void 0===a?void 0:a.startsWith("pl_"))&&(r.isBlocked||window.objectLocked&&window.objectLocked!==r||(r.distance=n.camera.position.distanceTo(r.position),window.selectedObj=r,n.OrbitControls.enabled=!1,window.selectedObj.originalPos=window.selectedObj.position,e.selectObject(r)))}},n=function(t){e.isEditMode&&window.selectedObj&&(window.selectedObj.type.startsWith("pl_")&&(window.pl.viewer.OrbitControls.enabled=!0,f({object3D:window.selectedObj,getOptionsByObject3D:e.getOptionsByObject3D,setPlOptions:e.setPlOptions,plOptionsReplaceWorldParamsHotspot:e.plOptionsReplaceWorldParamsHotspot}),window.selectedObj=null))};return s.a.createElement(S.a,null,s.a.createElement("div",{className:"w-100",onMouseMove:function(t){return w(0,{setEditParams:e.setEditParams,editParams:e.editParams})}},s.a.createElement("div",{id:e.editParams.POSTERLENS_CONTAINER_ID,className:"posterlens-container"})))},I=a(14),M=a(20);var T=function(e){var t,a=Object(i.useState)(null!==(t=window.plImgPath)&&void 0!==t?t:"resources/"),n=Object(c.a)(a,2),l=n[0],o=n[1],p=Object(i.createRef)();Object(i.useEffect)((function(){window.pl&&document.addEventListener("keydown",(function(e){d(e)}))}),[]);var d=function(t){var a,n;if(window.lastSelectedObj&&t.ctrlKey){var l=e.editParams.SCALE_FACTOR*(t.shiftKey?2:1),o=e.editParams.ROTATE_DEG*(t.shiftKey?2:1),c=.5*(t.shiftKey?6:1);if("SpriteMaterial"===window.lastSelectedObj.material.type&&!["4","5","+","-","q"].includes(t.key))return;switch(t.key){case"+":window.lastSelectedObj.scale.set(window.lastSelectedObj.scale.x*l,window.lastSelectedObj.scale.y*l,window.lastSelectedObj.scale.z*l);break;case"-":window.lastSelectedObj.scale.set(window.lastSelectedObj.scale.x/l,window.lastSelectedObj.scale.y/l,window.lastSelectedObj.scale.z/l);break;case"r":window.lastSelectedObj.rotation.x=parseInt(100*(window.lastSelectedObj.rotation.x+o))/100;break;case"t":window.lastSelectedObj.rotation.x=parseInt(100*(window.lastSelectedObj.rotation.x-o))/100;break;case"f":window.lastSelectedObj.rotation.y=parseInt(100*(window.lastSelectedObj.rotation.y+o))/100;break;case"g":window.lastSelectedObj.rotation.y=parseInt(100*(window.lastSelectedObj.rotation.y-o))/100;break;case"v":window.lastSelectedObj.rotation.z=parseInt(100*(window.lastSelectedObj.rotation.z+o))/100;break;case"b":window.lastSelectedObj.rotation.z=parseInt(100*(window.lastSelectedObj.rotation.z-o))/100;break;case"4":x(window.lastSelectedObj,"close");break;case"5":x(window.lastSelectedObj,"far");break;case"w":case"W":window.lastSelectedObj.translateY(c);break;case"s":case"S":window.lastSelectedObj.translateY(-c);break;case"d":case"D":window.lastSelectedObj.translateX(c);break;case"a":case"A":window.lastSelectedObj.translateX(-c);break;case"q":var i=!window.objectLocked;i?(window.lastSelectedObj.originalColor=i?window.lastSelectedObj.material.color:null,window.lastSelectedObj.material.color={r:1,g:0,b:0},window.pl.el.classList.add("locked-element"),window.objectLocked=window.lastSelectedObj):(window.objectLocked.material.color=window.objectLocked.originalColor,window.pl.el.classList.remove("locked-element"),window.objectLocked=null);break;case"z":window.lastSelectedObj.lastPosition&&(a=window.lastSelectedObj.position).set.apply(a,Object(r.a)(Object.values(window.lastSelectedObj.lastPosition))),window.lastSelectedObj.lastRotation&&(n=window.lastSelectedObj.rotation).set.apply(n,Object(r.a)(Object.values(window.lastSelectedObj.lastRotation))),window.lastSelectedObj.lastPosition=window.lastSelectedObj.lastRotation=null}e.setCurrentObject3D(window.lastSelectedObj),window.waitSave&&clearTimeout(window.waitSave),window.waitSave=setTimeout((function(){f({object3D:window.lastSelectedObj,getOptionsByObject3D:e.getOptionsByObject3D,setPlOptions:e.setPlOptions,plOptionsReplaceWorldParamsHotspot:e.plOptionsReplaceWorldParamsHotspot}),clearTimeout(window.waitSave)}),200)}},m={};e.plOptions&&e.plOptions.worlds.forEach((function(e){return m[e.name]=e.name}));var b=[[{option:"image",type:e.appAsWidget?"image-pick":"image",label:"Img",active:["pl_poster3d"],deleteIfValue:""},{option:"alpha",type:e.appAsWidget?"image-pick":"image",label:"Alpha",active:["pl_poster3d"],deleteIfValue:""},{option:"text",type:"input",label:"Text",active:["pl_text-2d","pl_text-3d"]},{option:"emissive",type:"color",label:"Emissive Color",active:["pl_text-3d"],deleteIfValue:"#ffffff"},{option:"color",type:"color",label:"Text Color",active:["pl_text-2d"],deleteIfValue:"#ffffff"},{option:"background",type:"color",label:"Background",active:["pl_text-2d"],deleteIfValue:"#000000"},{option:"alwaysLookatCamera",type:"checkbox",label:"alwaysLookatCamera",checkedValue:function(){return!0},uncheckedValue:function(){return!1},active:["pl_text-2d","pl_text-3d","pl_poster3d"],deleteIfValue:!0},{option:"sprite",type:"checkbox",label:"sprite 2D",checkedValue:function(){return!0},uncheckedValue:function(){return null},active:["pl_text-2d","pl_poster3d"],deleteIfValue:!1},{option:"posterSphere",type:"checkbox",label:"is sphere",checkedValue:function(){return!0},uncheckedValue:function(){return null},active:["pl_text-2d","pl_poster3d"],deleteIfValue:!1},{option:"opacity",type:"number",step:.05,min:0,max:1,label:"Opacity",active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:"1"}],[{option:"animatedMap",type:"number",label:"frames",active:["pl_poster3d"],deleteIfValue:""},{option:"animatedMapSpeed",type:"number",label:"speed",active:["pl_poster3d"],deleteIfValue:""},{option:"rotationX",type:"number",label:"\u213a animat",placeholder:"x",step:100,active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""},{option:"rotationY",type:"number",label:"",placeholder:"y",step:100,active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""},{option:"rotationZ",type:"number",label:"",placeholder:"z",step:100,active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""},{option:"animated",type:"select",label:"Glow animation",options:{always:"always","only on hover":"hover"},active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""},{option:"popupWhenVisible",type:"number",step:10,label:"Pops up when in camera",active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""}]];return s.a.createElement(M.a,{className:"edit-panel"},e.currentObject3D?s.a.createElement(S.a,{className:"no-gutters",style:{marginTop:"-20px"}},s.a.createElement(y,{input:{option:"name",type:"input",label:"",active:["pl_poster3d","pl_text-2d","pl_text-3d"]},currentObject3D:e.currentObject3D,getOptionsByObject3D:e.getOptionsByObject3D,getCurrentPanoramaParams:e.getCurrentPanoramaParams,plOptionsReplaceWorldParamsHotspot:e.plOptionsReplaceWorldParamsHotspot,setPlOptions:e.setPlOptions,selectObject:e.selectObject,setCurrentObject3D:e.setCurrentObject3D,class:"col-5 mb-3"}),s.a.createElement("div",{className:"col-7"},s.a.createElement(h,{class:"row",getCurrentPanoramaParams:e.getCurrentPanoramaParams,currentObject3D:e.currentObject3D,setPlOptions:e.setPlOptions,plOptionsReplaceWorldParamsHotspot:e.plOptionsReplaceWorldParamsHotspot,getOptionsByObject3D:e.getOptionsByObject3D,selectObject:e.selectObject,setCurrentObject3D:e.setCurrentObject3D}))):null,e.appAsWidget?null:s.a.createElement(u.a,null,s.a.createElement(u.a.Prepend,null," ",s.a.createElement(u.a.Text,null,"imgs path")),s.a.createElement(g.a,{as:"input",defaultValue:l,ref:p,onChange:function(e){return p.current?o(p.current.value):null}}),s.a.createElement(u.a.Append,null,s.a.createElement(u.a.Text,null," ",l," ")," ")),s.a.createElement(S.a,null,b.map((function(t,a){return s.a.createElement(I.a,{sm:"4",className:"border bg-light",key:"column-"+a},s.a.createElement("label",{className:"d-block h5"},0===a?"Main props":"Animation"),t.map((function(t,a){return e.currentObject3D&&t.active.includes(e.currentObject3D.type)?s.a.createElement(y,{input:t,imgPath:l,key:"input-"+a,currentObject3D:e.currentObject3D,setCurrentObject3D:e.setCurrentObject3D,getOptionsByObject3D:e.getOptionsByObject3D,getCurrentPanoramaParams:e.getCurrentPanoramaParams,plOptionsReplaceWorldParamsHotspot:e.plOptionsReplaceWorldParamsHotspot,setPlOptions:e.setPlOptions,selectObject:e.selectObject}):null})))})),s.a.createElement(I.a,{sm:"4",className:"border bg-light"},s.a.createElement("label",{className:"d-block h5"},"Action"),s.a.createElement(C,{key:e.getOptionsByObject3D?e.getOptionsByObject3D.name:"not",plOptions:e.plOptions,currentObject3D:e.currentObject3D,getOptionsByObject3D:e.getOptionsByObject3D,onClickOption:e.onClickOption,setOnClickOption:e.setOnClickOption,getCurrentPanoramaParams:e.getCurrentPanoramaParams,plOptionsReplaceWorldParamsHotspot:e.plOptionsReplaceWorldParamsHotspot,setPlOptions:e.setPlOptions,selectObject:e.selectObject,setCurrentObject3D:e.setCurrentObject3D}),[{option:"hoverText",type:"textarea",label:"hoverText",deleteIfValue:"",active:["pl_poster3d","pl_text-2d","pl_text-3d"]},{option:"hoverTextClass",type:"select",options:{type1:"type1"},label:"Hover box style",active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""}].map((function(t,a){return s.a.createElement(y,{input:t,key:"input-3rd-column-"+a,currentObject3D:e.currentObject3D,getOptionsByObject3D:e.getOptionsByObject3D,onClickOption:e.onClickOption,setOnClickOption:e.setOnClickOption,getCurrentPanoramaParams:e.getCurrentPanoramaParams,plOptionsReplaceWorldParamsHotspot:e.plOptionsReplaceWorldParamsHotspot,setPlOptions:e.setPlOptions,selectObject:e.selectObject,setCurrentObject3D:e.setCurrentObject3D})})))))};function R(e){var t,a,n,l,r,o,p,u,d,m,b,w,_=Object(i.useState)(e.editParams.isExpertMode),j=Object(c.a)(_,2),f=j[0],v=j[1];function E(){if(e.currentObject3D){var t=e.getCurrentPanoramaParams();if(t)return t.hotspots.find((function(t){var a;return t.name===(null===(a=e.currentObject3D)||void 0===a?void 0:a.name)}))}}return s.a.createElement("div",{className:"object-info position-absolute",onClick:function(){return v(!f)}},s.a.createElement("h4",null,null===(t=e.currentObject3D)||void 0===t?void 0:t.name,s.a.createElement("small",null," (",null===(a=e.currentObject3D)||void 0===a?void 0:a.type,")")),s.a.createElement("div",{className:f?"d-block":"d-none"},"Pos: ",O(null===(n=e.currentObject3D)||void 0===n?void 0:n.position.x)," ",O(null===(l=e.currentObject3D)||void 0===l?void 0:l.position.y)," ",O(null===(r=e.currentObject3D)||void 0===r?void 0:r.position.z),s.a.createElement("br",null),"Rot: x ",O(null===(o=e.currentObject3D)||void 0===o?void 0:o.rotation.x)," / y ",O(null===(p=e.currentObject3D)||void 0===p?void 0:p.rotation.y)," / z ",O(null===(u=e.currentObject3D)||void 0===u?void 0:u.rotation.z),(null===(d=E())||void 0===d?void 0:d.alwaysLookatCamera)?"(alwayslookatcamera)":null,s.a.createElement("br",null),"Scale: ",O(null===(m=e.currentObject3D)||void 0===m?void 0:m.scale.x)," ",O(null===(b=e.currentObject3D)||void 0===b?void 0:b.scale.y)," ",O(null===(w=e.currentObject3D)||void 0===w?void 0:w.scale.z),s.a.createElement(s.a.Fragment,null,s.a.createElement("br",null),s.a.createElement("b",null,"Object Info in options:")," ",s.a.createElement("br",null),function(){var e=E(),t=(e?JSON.stringify(e,!1,2):"no sel").split("\n"),a=[];return t.forEach((function(e,t){a.push(e),a.push(s.a.createElement("br",{key:"return-"+t}))})),a}())))}function W(e){var t,a=Object(i.useState)(null),n=Object(c.a)(a,2),l=n[0],r=n[1],o=Object(i.useState)(!1),p=Object(c.a)(o,2),u=p[0],d=p[1];Object(i.useEffect)((function(){console.log("\ud83d\udeb4\ud83c\udffc\u200d\u2640\ufe0fHello from PanelListObjects_Left"),r(e.getCurrentPanoramaParams())}),[e.plOptions]);return s.a.createElement(I.a,{className:(u?"all-unblocked ":"")+"list-objects",sm:"2"},"List Hotposts in Pano Options",s.a.createElement("button",{className:(u?"btn-danger":"btn-primary")+" btn btn-sm",onClick:function(e){e.preventDefault(),function(e){if(!l||!l.hotspots)return!1;var t=!u;t?l.hotspots.forEach((function(e,t){e.isBlockedBackup=e.isBlocked;var a=window.pl.getObjectByName(e.name);e.isBlocked=!1,a&&(a.isBlocked=!1,a.material.blending=1)})):l.hotspots.forEach((function(e,t){e.isBlocked=e.isBlockedBackup;var a=window.pl.getObjectByName(e.name);e.isBlocked&&(a.material.blending=3,a.isBlocked=!0)})),d(t)}()}},u?"Activate":"Deactivate"," locking objects"),l&&(null===(t=e.plOptions)||void 0===t?void 0:t.worlds)?s.a.createElement("ul",{className:"list-unstyled"},l.hotspots.map((function(t,a){var n,l;return s.a.createElement("li",{key:a,className:t.isBlocked?"is-blocked":""},s.a.createElement("div",{onClick:function(e){return function(e){var t=window.pl.getObjectByName(e.name);t&&(e.isBlocked=t.isBlocked=!e.isBlocked,t.material.blending=e.isBlocked?3:1)}(t)},className:"float-left mr-3"},(l=t).isBlocked?s.a.createElement("span",null,"\ud83d\udd11"):"text-3d"===l.type?s.a.createElement("span",null,"\ud835\udd38"):"text-2d"===l.type?s.a.createElement("span",null,"\ud835\udc34"):s.a.createElement("span",null,"\ud83c\udf5e")),s.a.createElement("div",{onClick:function(){var a=window.pl.getObjectByName(t.name);e.selectObject(a)},className:(null===(n=e.currentObject3D)||void 0===n?void 0:n.name)===t.name?"object-selected":""},t.name,s.a.createElement("small",{className:"ml-3"},t.type)))}))):null,s.a.createElement("br",null)," ",e.editParams.isExpertMode?s.a.createElement(s.a.Fragment,null,"Camera: ",window.pl?window.pl.getCameraDirection("lookatPoint").join(", "):null,s.a.createElement("br",null),"Angle: ",window.pl?Math.round(100*window.pl.getCameraDirection("rad"))/100:null,"rad :: ",window.pl?Math.round(window.pl.getCameraDirection("deg")):null,"\xba",s.a.createElement("br",null),"Fov: ",window.pl?window.pl.viewer.camera.fov:null,s.a.createElement("br",null),"MousePos: ",e.editParams.currentMouse3DPosition.join(", "),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("i",null,"panorama.objectsToPopupWhenVisible:")," ",l?window.pl?window.pl.viewer.panorama.objectsToPopupWhenVisible?s.a.createElement("div",null," ",Object.keys(window.pl.viewer.panorama.objectsToPopupWhenVisible).map((function(e){var t=Object(c.a)(window.pl.viewer.panorama.objectsToPopupWhenVisible[e],2),a=t[0],n=t[1];return s.a.createElement("p",{key:e},e," : ",a,"\xba, ",n,"\xba")}))," "):"none":"not loaded":null):null)}function N(e){var t=Object(i.useState)(e.editParams.isExpertMode),a=Object(c.a)(t,2),n=a[0],l=a[1];return s.a.createElement("div",{className:"object-info position-absolute",onClick:function(){return l(!n)}},s.a.createElement("div",{className:n?"d-block":"d-none"},s.a.createElement(s.a.Fragment,null,s.a.createElement("br",null),s.a.createElement("b",null,"Panorama in options:")," ",s.a.createElement("br",null),function(){var t=function(){var t=e.getCurrentPanoramaParams();if(t){var a=Object(o.a)({},t);return delete a.hotspots,a}}(),a=(t?JSON.stringify(t,!1,2):"no sel").split("\n"),n=[];return a.forEach((function(e,t){n.push(e),n.push(s.a.createElement("br",{key:"return-"+t}))})),n}())))}function B(e){return s.a.createElement(S.a,{className:"top-buttons"},e.currentObject3D?s.a.createElement(R,{currentObject3D:e.currentObject3D,getCurrentPanoramaParams:e.getCurrentPanoramaParams,editParams:e.editParams}):s.a.createElement(N,{currentObject3D:e.currentObject3D,getCurrentPanoramaParams:e.getCurrentPanoramaParams,editParams:e.editParams}),e.plOptions?s.a.createElement(W,{currentObject3D:e.currentObject3D,plOptions:e.plOptions,selectObject:e.selectObject,editParams:e.editParams,setCurrentObject3D:e.setCurrentObject3D,getCurrentPanoramaParams:e.getCurrentPanoramaParams}):null,s.a.createElement(p.a,{className:"btn btn-danger btn-sm",onClick:function(t){localStorage.removeItem("pl.o"),e.restartViewer()}},"Undo changes"),e.plOptions&&e.editParams.isExpertMode?s.a.createElement(s.a.Fragment,null,s.a.createElement(p.a,{className:"btn-sm",onClick:function(t){return e.restartViewer()}},"Restart ",s.a.createElement("span",{className:"badge"},e.countRestarts))):null,e.editParams.isExpertMode?s.a.createElement(p.a,{className:"btn-secondary ml-5 btn-sm",onClick:function(){return e.exportToTextarea()}},"Export"):null,e.currentObject3D?s.a.createElement(s.a.Fragment,null,s.a.createElement(p.a,{className:"btn btn-danger btn-sm",onClick:e.removeCurrentObject},"Delete"),s.a.createElement(p.a,{className:"btn btn-success btn-sm",onClick:e.cloneCurrentObject},"Clone"),s.a.createElement(p.a,{className:"btn btn-warning btn-sm",onClick:function(){e.setCurrentObject3D(null),window.lastSelectedObj=null}},"Unselect")):null,s.a.createElement(p.a,{variant:"outline-secondary btn-sm ml-3",onClick:function(t){return e.setAppMode("demo")}},"Demo"),s.a.createElement(p.a,{variant:"primary",className:"ml-5 set-camera-view",onClick:function(t){var a=e.getCurrentPanoramaParams();a.initialLookAt=window.pl.getCameraDirection("lookatPoint"),a.initialFov=window.pl.viewer.camera.fov,j(e.plOptionsReplaceWorldParams(a),e.setPlOptions),localStorage.setItem("lastCameraLookat",window.pl.getCameraDirection("lookatPoint"))}},"Set camera view"))}var L=function(e){var t,a,n=null===(t=window.pl)||void 0===t?void 0:t.viewer;if(null===(a=window.pl)||void 0===a?void 0:a.el){var l=window.pl.el.querySelector("div:last-child");l&&l.classList.add("pl-widgets")}var r=Object(i.useState)(!1),o=Object(c.a)(r,2),s=o[0],p=o[1];Object(i.useEffect)((function(){console.log("Hellow from widgets"),window.pl&&e.isEditMode&&(s||(p(!0),"undefined"===typeof window.basePath&&(window.basePath="./"),Array.from(["poster3d","text-3d","text-2d"]).forEach((function(t){n.appendControlItem({id:"edit-controls",style:{backgroundImage:"url("+window.basePath+"resources/widget-"+t+".png)",float:"left"},onTap:function(){var a=window.pl.viewer.panorama.children.length;if(e.editParams.MAX_OBJECTS_PER_PANO<=a-1)alert("You can't create more elements. Upgrade the plugin for infinite posters.");else{var n=u(t),l=n.newObj,r=n.objectData;console.log("Created new obj: ",{newObj:l,objectData:r})}},group:"editmode"});var a=window.pl.el?window.pl.el.querySelector(".pl-widgets > span:last-child"):null;a&&(a.classList.add("widget"),a.classList.add("widget-btn-"+t))}))))}),[e.countResets]);var u=function(){var t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"poster3d",l={name:null!==(t=window.newName)&&void 0!==t?t:"new_".concat(a,"_")+Math.floor(1e4*Math.random()),type:a,pos:Object.values(n.camera.getWorldDirection(new window.THREE.Vector3).multiplyScalar(300))};switch(a){case"poster3d":l.image=window.defaultPosterImg?window.defaultPosterImg:window.basePath+"resources/poster3.jpg";break;case"poster3d-sphere":l.image=window.defaultPosterImg?window.defaultPosterImg:window.basePath+"resources/poster3.jpg",l.type="poster3d",l.posterSphere=!0;break;case"text-2d":l.text="New text";break;case"text-3d":l.type="text-3d",l.fontFamily=window.basePath+"resources/fonts/Century_Gothic_Regular.js",l.text="New text"}l.creationCallback=function(t){return e.selectObject(t)},window.pl.createNewObjectFromParams(n.panorama,l);var r=e.getCurrentPanoramaParams();r.hotspots.push(l);var o=e.plOptionsReplaceWorldParams(r);return e.setPlOptions(o),l};return null};function V(e){var t,a=e.data,p=e.setAppMode,u=e.appAsWidget,d=e.codeValidation,m=Object(i.useState)(),b=Object(c.a)(m,2),O=b[0],w=b[1],f=Object(i.useState)(null),v=Object(c.a)(f,2),E=v[0],P=v[1],g=Object(i.useState)(!1),D=Object(c.a)(g,2),y=D[0],C=D[1],k=Object(i.useState)(!1),h=Object(c.a)(k,2),x=h[0],I=h[1],R=Object(i.useState)({POSTERLENS_CONTAINER_ID:"posterlens-container",SCALE_FACTOR:1.01,ROTATE_DEG:.05,currentMouse3DPosition:[0,0,0],AUTO_START_EDIT_MODE:1,codeValidated:_(d),MAX_OBJECTS_PER_PANO:_(d)?1e3:3,isExpertMode:"undefined"===typeof window.expertMode||window.expertMode}),W=Object(c.a)(R,2),N=W[0],V=W[1],H=Object(i.useState)(0),U=Object(c.a)(H,2),q=U[0],z=U[1],K=Object(i.useState)(null),F=Object(c.a)(K,2),J=F[0],G=F[1];function X(){var e={};a?e=Object(o.a)({},a):console.log("data variable not found."),x?e=JSON.parse(x):I(JSON.stringify(a));var t=JSON.parse(localStorage.getItem("pl.o"));(e=(null===t||void 0===t?void 0:t.worlds)?t:e)?(window.plEditMode=!0,window.pl=document.querySelector("#"+N.POSTERLENS_CONTAINER_ID).posterlens(e),w(window.pl.o),window.pl.viewer.panorama.addEventListener("load",(function(){var e=localStorage.getItem("lastSelectedObj.name");if(e){var t=window.pl.getObjectByName(e);t&&ae(t)}window.scene=window.pl.viewer.getScene(),y&&window.stopAllAnimations(window.pl.viewer)}))):console.error("No data loaded. Cant initialize")}function Y(){alert("restarting viewer"),console.log("plOptions",O),document.querySelector("#"+N.POSTERLENS_CONTAINER_ID).innerHTML="",w(null),C(!1),localStorage.setItem("lastCameraLookat",window.pl.getCameraDirection("lookatPoint")),localStorage.setItem("currentPano",window.pl.viewer.panorama.name),delete window.pl,X(),z(q+1),setTimeout((function(){var e=document.querySelector("#input-name form");e&&e.dispatchEvent(new Event("submit"));var t=localStorage.getItem("lastCameraLookat").split(",");t=t.map((function(e){return parseInt(e)})),window.pl.viewer.setControlCenter(Object(l.a)(window.THREE.Vector3,Object(r.a)(t))),localStorage.removeItem("lastCameraLookat");var a=localStorage.getItem("currentPano");a&&window.pl.changePano(a)}),500)}function Z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=Q();if(a){var n=a.hotspots.find((function(t){return t.name===(null===e||void 0===e?void 0:e.name)}));return n&&t?n[t]:n}}function Q(){return O?O.worlds.find((function(e){return e.name===window.pl.viewer.panorama.name})):null}function $(){return O.worlds.findIndex((function(e){return e.name===window.pl.viewer.panorama.name}))}function ee(e){var t=Object.assign({},O);return t.worlds[$()]=Object(o.a)({},e),t}function te(e,t){var a=Q(),n=a.hotspots.findIndex((function(t){return t.name===e}));if(!(n<0)){var l=Object(r.a)(a.hotspots);return l[n]=t,a.hotspots=l,ee(a)}}function ae(e){if(!e)return!1;window.lastSelectedObj=e,window.lastSelectedObj.lastPosition=window.lastSelectedObj.position.clone(),window.lastSelectedObj.lastRotation=window.lastSelectedObj.rotation.clone(),P(e)}return Object(i.useEffect)((function(){console.log("INIT AppEditPosterlens! React rocks \ud83e\udd18"),X(),z(1)}),[]),Object(i.useEffect)((function(){window.pl&&N.AUTO_START_EDIT_MODE&&C(!0)}),[q]),Object(i.useEffect)((function(){if(E){localStorage.setItem("lastSelectedObj.name",E.name),function(e){var t=e.getOptionsByObject3D(e.currentObject3D);document.querySelectorAll("[sync-3d]").forEach((function(a){var n=a.getAttribute("sync-3d"),l="undefined"!==typeof t[n]?t[n]:"";if(n.includes(".")){var r=n.split(".");l=t[r[0]]?t[r[0]][r[1]]:""}var o=a.getAttribute("sync-default");o="undefined"===typeof o||"false"===o?"":o,""===l&&o&&(l=o),a.querySelector("input")&&(a.querySelector("input").value=l),a.querySelector("select")&&(a.querySelector("select").value=l),a.querySelector('input[type="checkbox"]')&&(a.querySelector('input[type="checkbox"]').checked=!!l),"onClickAction"===n&&e.setOnClickOption&&e.setOnClickOption(l),"distance"===n&&(a.querySelector("input").value=window.pl.viewer.camera.position.distanceTo(e.currentObject3D.position))}))}({currentObject3D:E,getOptionsByObject3D:Z,setOnClickOption:G});var e=E.material.blending,t=E.material.color;E.material.blending=2,"pl_text-3d"===E.type&&(E.material.wireframe=!0),E.material.color={r:0,g:1,b:0},setTimeout((function(){E.material.blending=e,E.material.color=t}),800)}}),[E]),Object(i.useEffect)((function(){window.pl.viewer.editMode=y}),[y]),s.a.createElement(M.a,{className:"posterlens-wrapper border pt-2"+(N.codeValidated?" validated ":"")+(N.isExpertMode?" expert-mode":" no-expert-mode")},s.a.createElement(B,{data:a,currentObject3D:E,setCurrentObject3D:P,getCurrentPanoramaParams:Q,plOptions:O,setPlOptions:w,editParams:N,selectObject:ae,plOptionsReplaceWorldParams:ee,restartViewer:Y,removeCurrentObject:function(){if(E){var e=Q(),t=$(),a=(e.hotspots.findIndex((function(e){return e.name===E.name})),Object(r.a)(e.hotspots)),n=a.findIndex((function(e){return e.name===E.name}));a.splice(n,1);var l=Object(o.a)({},O);l.worlds[t].hotspots=a,j(l,w),window.pl.viewer.panorama.remove(E),window.pl.viewer.panorama.remove(window.pl.viewer.scene.getChildByName(E.name)),P(null)}},setAppMode:p,countRestarts:q,exportToTextarea:function(){var e=JSON.stringify(O,!1,2),t=document.createElement("textarea");t.textContent=e,t.style.width="100%",t.style.height="500px",window.pl.Modal("Export JSON",t)},cloneCurrentObject:function(){if(E){var e=Object.assign({},Z(E)),t=Q(),a="cloned_"+e.name;e.name=a,e.pos=[parseFloat(e.pos[0])+50,parseFloat(e.pos[1])+50,e.pos[2]],t.hotspots.push(e),j(ee(t),w),localStorage.setItem("lastSelectedObj.name",a),Y()}}}),s.a.createElement(A,{editParams:N,setEditParams:V,isEditMode:y,getOptionsByObject3D:Z,selectObject:ae,plOptions:O,setPlOptions:w,plOptionsReplaceWorldParamsHotspot:te}),y?s.a.createElement(S.a,{className:"no-gutters"},s.a.createElement(T,{plOptions:O,setPlOptions:w,isEditMode:y,editParams:N,setEditParams:V,currentObject3D:E,setCurrentObject3D:P,plOptionsReplaceWorldParamsHotspot:te,getCurrentPanoramaParams:Q,selectObject:ae,getOptionsByObject3D:Z,appAsWidget:u,plOptionsReplaceWorldParams:ee,onClickOption:J,setOnClickOption:G})):null,y?s.a.createElement(L,(t={plOptions:O,isEditMode:y,setIsEditMode:C,setCurrentObject3D:P},Object(n.a)(t,"plOptions",O),Object(n.a)(t,"key",q),Object(n.a)(t,"restartViewer",Y),Object(n.a)(t,"selectObject",ae),Object(n.a)(t,"plOptionsReplaceWorldParams",ee),Object(n.a)(t,"getCurrentPanoramaParams",Q),Object(n.a)(t,"setPlOptions",w),Object(n.a)(t,"editParams",N),t)):null)}},32:function(e,t,a){e.exports=a(33)},33:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(27),o=a.n(r),c=(a(38),a(28));document.querySelectorAll(".wrapper-posterlens-edit-container").forEach((function(e,t){o.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(c.a,null)),e)}))},38:function(e,t,a){},42:function(e,t,a){}},[[32,1,2]]]);
//# sourceMappingURL=main.f0c24f8b.chunk.js.map