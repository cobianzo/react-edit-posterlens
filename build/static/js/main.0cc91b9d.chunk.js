(this["webpackJsonpflux-todo"]=this["webpackJsonpflux-todo"]||[]).push([[0],{27:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return AppEditPosterlens}));var _Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9),_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(17),_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(21),_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8),react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_4__),_EditObject2__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(33),_ListObjects__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(29),_Widgets__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(30),_ObjectInfo__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(31),_helpers__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(7),bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(43),bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_10__),react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(10),react_bootstrap_Container__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(19),react_bootstrap_Row__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(20),react_bootstrap_Col__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(12);function AppEditPosterlens(_ref){var _React$createElement,data=_ref.data,setAppMode=_ref.setAppMode,_useState=Object(react__WEBPACK_IMPORTED_MODULE_4__.useState)(),_useState2=Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(_useState,2),plOptions=_useState2[0],setPlOptions=_useState2[1],_useState3=Object(react__WEBPACK_IMPORTED_MODULE_4__.useState)(null),_useState4=Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(_useState3,2),currentObject3D=_useState4[0],setCurrentObject3D=_useState4[1],_useState5=Object(react__WEBPACK_IMPORTED_MODULE_4__.useState)(!1),_useState6=Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(_useState5,2),isEditMode=_useState6[0],setIsEditMode=_useState6[1],_useState7=Object(react__WEBPACK_IMPORTED_MODULE_4__.useState)({POSTERLENS_CONTAINER_ID:"posterlens-container",SCALE_FACTOR:1.01,ROTATE_DEG:.05,currentMouse3DPosition:[0,0,0],AUTO_START_EDIT_MODE:1}),_useState8=Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(_useState7,2),editParams=_useState8[0],setEditParams=_useState8[1],_useState9=Object(react__WEBPACK_IMPORTED_MODULE_4__.useState)(0),_useState10=Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(_useState9,2),countRestarts=_useState10[0],setCountRestarts=_useState10[1],_useState11=Object(react__WEBPACK_IMPORTED_MODULE_4__.useState)(""),_useState12=Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(_useState11,2),info=_useState12[0],setInfo=_useState12[1],refContainer=Object(react__WEBPACK_IMPORTED_MODULE_4__.createRef)(),refContainerParent=Object(react__WEBPACK_IMPORTED_MODULE_4__.createRef)(),globalVars={THREE:eval("THREE"),TWEEN:eval("TWEEN"),stopAllAnimations:eval("stopAllAnimations")};Object(react__WEBPACK_IMPORTED_MODULE_4__.useEffect)((function(){console.log("hello from useEffect in App"),createViewer(),setCountRestarts(1)}),[]),Object(react__WEBPACK_IMPORTED_MODULE_4__.useEffect)((function(){window.pl&&editParams.AUTO_START_EDIT_MODE&&setIsEditMode(!0)}),[countRestarts]),Object(react__WEBPACK_IMPORTED_MODULE_4__.useEffect)((function(){""!==info&&setTimeout((function(){return setInfo("")}),2e3)}),[info]),Object(react__WEBPACK_IMPORTED_MODULE_4__.useEffect)((function(){currentObject3D&&localStorage.setItem("lastSelectedObj.name",currentObject3D.name)}),[currentObject3D]);var getMouse3Dposition=function(e){if(window.pl){var t=window.pl.viewer;if(t){var a=t.raycaster.intersectObject(t.panorama,!0);if(!(a.length<=0))for(var n=0;n<a.length;){if("invisibleWorld"===a[n].object.name){var r=a[n].point.clone(),o=t.panorama.getWorldPosition(new globalVars.THREE.Vector3);r.sub(o);var _=[Math.round(r.x.toFixed(2)/2),Math.round(r.y.toFixed(2)/2),Math.round(r.z.toFixed(2)/2)];return setEditParams(Object.assign({},editParams,{currentMouse3DPosition:_})),_}n++}}else console.warn("Cant retrieve mouse pos, not viewer defined")}};function createViewer(){var e={};data?e=data:console.log("data variable not found.");var t=JSON.parse(localStorage.getItem("pl.o"));(e=(null===t||void 0===t?void 0:t.worlds)?t:e)?(window.pl=document.querySelector("#"+editParams.POSTERLENS_CONTAINER_ID).posterlens(e),setPlOptions(window.pl.o),window.pl.viewer.panorama.addEventListener("load",(function(){var e=localStorage.getItem("lastSelectedObj.name");if(e){var t=window.pl.getObjectByName(e);t&&setCurrentObject3D(t)}window.scene=window.pl.viewer.getScene(),isEditMode&&globalVars.stopAllAnimations(window.pl.viewer)}))):console.error("No data loaded. Cant initialize")}function restartViewer(){destroyViewer(),setPlOptions(null),setIsEditMode(!1),delete window.pl,createViewer(),setCountRestarts(countRestarts+1)}function getOptionsByObject3D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=getCurrentPanoramaParams(),n=a.hotspots.find((function(t){return t.name===(null===e||void 0===e?void 0:e.name)}));return n&&t?n[t]:n}function getCurrentPanoramaParams(){return plOptions.worlds.find((function(e){return e.name===window.pl.viewer.panorama.name}))}function getCurrentPanoramaParamsIndex(){return plOptions.worlds.findIndex((function(e){return e.name===window.pl.viewer.panorama.name}))}function plOptionsReplaceWorldParams(e){var t=Object.assign({},plOptions);return t.worlds[getCurrentPanoramaParamsIndex()]=Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.a)({},e),t}function plOptionsReplaceWorldParamsHotspot(e,t){var a=getCurrentPanoramaParams(),n=a.hotspots.findIndex((function(t){return t.name===e}));if(!(n<0)){var r=Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(a.hotspots);return r[n]=t,a.hotspots=r,plOptionsReplaceWorldParams(a)}}function syncPlOptionsAndLocalStorage(e){setPlOptions(e);var t=JSON.stringify(e,!1,2);return localStorage.setItem("pl.o",t),t}function singleObject3DToParams(e){var t=getOptionsByObject3D(e),a=Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.a)({},t);if(t){a.pos=[Object(_helpers__WEBPACK_IMPORTED_MODULE_9__.a)(e.position.x),Object(_helpers__WEBPACK_IMPORTED_MODULE_9__.a)(e.position.y),Object(_helpers__WEBPACK_IMPORTED_MODULE_9__.a)(e.position.z)],a.rot=[Object(_helpers__WEBPACK_IMPORTED_MODULE_9__.a)(e.rotation.x),Object(_helpers__WEBPACK_IMPORTED_MODULE_9__.a)(e.rotation.y),Object(_helpers__WEBPACK_IMPORTED_MODULE_9__.a)(e.rotation.z)],a.scale=Object(_helpers__WEBPACK_IMPORTED_MODULE_9__.a)(e.scale.x);var n={opacity:1,animatedMap:1},r={opacity:"material.opacity",type:"type"};switch(e.type){case"pl_text-3d":r.emissive="material.emissive",r.transparent="material.transparent";break;case"pl_text-2d-sprite":case"pl_text-2d":r.color="material.color"}return Object.keys(r).forEach((function(t){var o=r[t].split("."),_=e;o.forEach((function(e){return _=_[e]})),"type"===t&&(_=_.replace("pl_","")),null===_&&a.hasOwnProperty(t)?delete a[t]:n.hasOwnProperty(t)?n[t]!=_&&(a[t]=_):a[t]=_})),syncPlOptionsAndLocalStorage(plOptionsReplaceWorldParamsHotspot(e.name,a)),a}alert("error: no objectCP")}function selectObject(e){if(!e)return!1;window.lastSelectedObj=e,setCurrentObject3D(e)}function removeCurrentObject(){if(currentObject3D){var e=getCurrentPanoramaParams(),t=getCurrentPanoramaParamsIndex(),a=(e.hotspots.findIndex((function(e){return e.name===currentObject3D.name})),Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(e.hotspots)),n=a.findIndex((function(e){return e.name===currentObject3D.name}));a.splice(n,1);var r=Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.a)({},plOptions);r.worlds[t].hotspots=a,syncPlOptionsAndLocalStorage(r),window.pl.viewer.panorama.remove(currentObject3D),window.pl.viewer.panorama.remove(window.pl.viewer.scene.getChildByName(currentObject3D.name)),setCurrentObject3D(null)}}function cloneCurrentObject(){if(currentObject3D){var e=Object.assign({},getOptionsByObject3D(currentObject3D)),t=getCurrentPanoramaParams();e.name="cloned_"+e.name,e.pos=[e.pos[0],e.pos[1]+50,e.pos[2]],t.hotspots.push(e),syncPlOptionsAndLocalStorage(plOptionsReplaceWorldParams(t)),restartViewer()}}function exportToTextarea(){var e=JSON.stringify(plOptions,!1,2),t=document.createElement("textarea");t.textContent=e,t.style.width="100%",t.style.height="500px",window.pl.Modal("Export JSON",t)}Object(react__WEBPACK_IMPORTED_MODULE_4__.useEffect)((function(){window.pl.viewer.editMode=isEditMode}),[isEditMode]);var updateObjectSingleData=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=getCurrentPanoramaParams(),r=n.hotspots.findIndex((function(t){return t.name===e}));if(!(r<0)){var o=n.hotspots.find((function(t){return t.name===e}));o=Object.assign({},o,t),Object.keys(o).forEach((function(e){return null===o[e]&&delete o[e]}));var _=plOptionsReplaceWorldParamsHotspot(e,o);if(syncPlOptionsAndLocalStorage(_),a){var l=window.pl.getObjectByName(e);if(e&&window.pl.viewer.panorama&&o){window.pl.viewer.panorama.remove(l),window.pl.createNewObjectFromParams(window.pl.viewer.panorama,o);var c=window.pl.getObjectByName(e);setTimeout((function(){return selectObject(c)}),500)}else selectObject(l)}}};function destroyViewer(){document.querySelector("#"+editParams.POSTERLENS_CONTAINER_ID).innerHTML=""}return react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_4___default.a.Fragment,null,currentObject3D?react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_ObjectInfo__WEBPACK_IMPORTED_MODULE_8__.a,{currentObject3D:currentObject3D,getCurrentPanoramaParams:getCurrentPanoramaParams}):null,plOptions?react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_ListObjects__WEBPACK_IMPORTED_MODULE_6__.a,{currentObject3D:currentObject3D,plOptions:plOptions,selectObject:selectObject,setCurrentObject3D:setCurrentObject3D,getCurrentPanoramaParams:getCurrentPanoramaParams}):null,react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react_bootstrap_Container__WEBPACK_IMPORTED_MODULE_12__.a,{className:"wrapper border pt-2",style:{maxWidth:"1200px"}},plOptions?react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_11__.a,{className:"btn-sm",onClick:function(e){return restartViewer()}}," RESET ",react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement("span",{className:"badge"},countRestarts)," "):null,isEditMode?null:react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_11__.a,{className:"btn-secondary ml-5 btn-sm",onClick:setIsEditMode(!isEditMode)},"Start Edit Mode"),plOptions?react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_11__.a,{className:"btn btn-danger btn-sm",onClick:function(e){localStorage.setItem("pl.o",null),restartViewer()}},"Clear cache "):null,react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_11__.a,{className:"btn-secondary ml-5 btn-sm",onClick:function(){return exportToTextarea()}},"Export"),currentObject3D?react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_11__.a,{className:"btn btn-danger btn-sm",onClick:removeCurrentObject},"Delete"):null,currentObject3D?react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_11__.a,{className:"btn btn-success btn-sm",onClick:cloneCurrentObject},"Clone"):null,react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_11__.a,{variant:"outline-primary btn-sm",onClick:function(e){globalVars.stopAllAnimations(window.pl.viewer),e.target.remove()}},"Stop anim."),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react_bootstrap_Button__WEBPACK_IMPORTED_MODULE_11__.a,{variant:"outline-secondary btn-sm",onClick:function(e){return setAppMode("demo")}},"Demo"),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react_bootstrap_Row__WEBPACK_IMPORTED_MODULE_13__.a,{className:"no-gutters"},react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(react_bootstrap_Col__WEBPACK_IMPORTED_MODULE_14__.a,{sm:12},react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement("div",{onMouseMove:function(e){getMouse3Dposition(e)},ref:refContainerParent},react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement("div",{id:editParams.POSTERLENS_CONTAINER_ID,className:"posterlens-container",ref:refContainer}," "))),isEditMode?react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_EditObject2__WEBPACK_IMPORTED_MODULE_5__.a,{plOptions:plOptions,isEditMode:isEditMode,editParams:editParams,globalVars:globalVars,currentObject3D:currentObject3D,setCurrentObject3D:setCurrentObject3D,getMouse3Dposition:getMouse3Dposition,singleObject3DToParams:singleObject3DToParams,setInfo:setInfo,updateObjectSingleData:updateObjectSingleData,getCurrentPanoramaParams:getCurrentPanoramaParams,selectObject:selectObject,getOptionsByObject3D:getOptionsByObject3D}):null),react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement("div",{className:"info",style:{color:"red"}},info),isEditMode?react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_Widgets__WEBPACK_IMPORTED_MODULE_7__.a,(_React$createElement={plOptions:plOptions,isEditMode:isEditMode,setIsEditMode:setIsEditMode,globalVars:globalVars,setCurrentObject3D:setCurrentObject3D},Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(_React$createElement,"plOptions",plOptions),Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(_React$createElement,"singleObject3DToParams",singleObject3DToParams),Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(_React$createElement,"refContainer",refContainer),Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(_React$createElement,"key",countRestarts),Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(_React$createElement,"restartViewer",restartViewer),Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(_React$createElement,"plOptionsReplaceWorldParams",plOptionsReplaceWorldParams),Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(_React$createElement,"getCurrentPanoramaParams",getCurrentPanoramaParams),Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.a)(_React$createElement,"setPlOptions",setPlOptions),_React$createElement)):null))}},29:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(8),r=a(0),o=a.n(r),_=a(12);function l(e){var t,a=Object(r.useState)(null),l=Object(n.a)(a,2),c=l[0],s=l[1];Object(r.useEffect)((function(){console.log("\ud83d\udeb4\ud83c\udffc\u200d\u2640\ufe0fHello from ListObjects"),s(e.getCurrentPanoramaParams())}),[e.plOptions]);return o.a.createElement(_.a,{className:"list-objects",sm:"2"},"List Hotposts in Pano Options",c&&(null===(t=e.plOptions)||void 0===t?void 0:t.worlds)?o.a.createElement("ul",null,c.hotspots.map((function(t,a){var n;return o.a.createElement("li",{key:a,onClick:function(){var a=window.pl.getObjectByName(t.name);e.selectObject(a)},className:(null===(n=e.currentObject3D)||void 0===n?void 0:n.name)===t.name?"active":""},t.name," ",o.a.createElement("small",null,t.type))}))):null,o.a.createElement("br",null)," ","Camera: ",window.pl?window.pl.getCameraDirection("lookatPoint").join(", "):null,o.a.createElement("br",null),"Angle: ",window.pl?Math.round(100*window.pl.getCameraDirection("rad"))/100:null,"rad :: ",window.pl?Math.round(window.pl.getCameraDirection("deg")):null,"\xba",o.a.createElement("br",null),"Fov: ",window.pl?window.pl.viewer.camera.fov:null,o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("i",null,"Show if visible:")," ",c?window.pl?window.pl.viewer.panorama.objectsToPopupWhenVisible?o.a.createElement("div",null," ",Object.keys(window.pl.viewer.panorama.objectsToPopupWhenVisible).map((function(e){var t=Object(n.a)(window.pl.viewer.panorama.objectsToPopupWhenVisible[e],2),a=t[0],r=t[1];return o.a.createElement("p",{key:e},e," : ",a,"\xba, ",r,"\xba")}))," "):"none":"not loaded":null)}},30:function(e,t,a){"use strict";var n=a(8),r=a(0);t.a=function(e){var t,a=null===(t=window.pl)||void 0===t?void 0:t.viewer,o=Object(r.useState)(!1),_=Object(n.a)(o,2),l=_[0],c=_[1];Object(r.useEffect)((function(){console.log("Hellow from widgets"),window.pl&&e.isEditMode&&(l||(c(!0),a.appendControlItem({style:{backgroundImage:"url(https://images-na.ssl-images-amazon.com/images/I/91ovrqFkzkL._RI_SX200_.jpg)",float:"left"},onTap:function(){var t=!e.isEditMode;e.setIsEditMode(t),t&&"undefined"!==typeof e.globalVars.stopAllAnimations&&e.globalVars.stopAllAnimations(a)},group:"editmode"}),Array.from(["poster-sprite","poster3d","poster3d-sphere","text-3d","text-2d","text-2d-sprite"]).forEach((function(e){a.appendControlItem({id:"edit-controls",style:{backgroundImage:"url(posterlens/assets/widget-"+e+".png)",float:"left"},onTap:function(){var t=s(e),a=t.newObj,n=t.objectData;console.log("Created new obj: ",{newObj:a,objectData:n})},group:"editmode"})}))))}),[e.countResets]);var s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"poster3d",n={name:"new_".concat(t,"_")+Math.floor(1e4*Math.random()),type:t,pos:Object.values(a.camera.getWorldDirection(new e.globalVars.THREE.Vector3).multiplyScalar(300))};switch(t){case"poster3d":n.image="resources/poster3.jpg";break;case"poster3d-sphere":n.image="resources/poster3.jpg",n.type="poster3d",n.posterSphere=!0;break;case"poster-sprite":break;case"text-2d":n.text="New text";break;case"text-2d-sprite":n.text="New text",n.sprite=!0,n.type="text-2d";break;case"text-3d":n.fontFamily="posterlens/assets/fonts/Century_Gothic_Regular.js",n.text="New text"}window.pl.createNewObjectFromParams(a.panorama,n);var r=window.pl.viewer.panorama.getObjectByName(n.name);e.setCurrentObject3D(r);var o=e.getCurrentPanoramaParams();o.hotspots.push(n);var _=e.plOptionsReplaceWorldParams(o);return e.setPlOptions(_),{newObj:r,params:n}};return null}},31:function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n=a(0),r=a.n(n),o=a(7);function _(e){var t,a,n,_,l,c,s,i,u,p,d,m;function O(){if(e.currentObject3D)return e.getCurrentPanoramaParams().hotspots.find((function(t){var a;return t.name===(null===(a=e.currentObject3D)||void 0===a?void 0:a.name)}))}return r.a.createElement("div",{className:"object-info position-absolute"},r.a.createElement("h4",null,null===(t=e.currentObject3D)||void 0===t?void 0:t.name,r.a.createElement("small",null," (",null===(a=e.currentObject3D)||void 0===a?void 0:a.type,")")),"Pos: ",Object(o.a)(null===(n=e.currentObject3D)||void 0===n?void 0:n.position.x)," ",Object(o.a)(null===(_=e.currentObject3D)||void 0===_?void 0:_.position.y)," ",Object(o.a)(null===(l=e.currentObject3D)||void 0===l?void 0:l.position.z),r.a.createElement("br",null),"Rot: x ",Object(o.a)(null===(c=e.currentObject3D)||void 0===c?void 0:c.rotation.x)," / y ",Object(o.a)(null===(s=e.currentObject3D)||void 0===s?void 0:s.rotation.y)," / z ",Object(o.a)(null===(i=e.currentObject3D)||void 0===i?void 0:i.rotation.z),(null===(u=O())||void 0===u?void 0:u.alwaysLookatCamera)?"(alwayslookatcamera)":null,r.a.createElement("br",null),"Scale: ",Object(o.a)(null===(p=e.currentObject3D)||void 0===p?void 0:p.scale.x)," ",Object(o.a)(null===(d=e.currentObject3D)||void 0===d?void 0:d.scale.y)," ",Object(o.a)(null===(m=e.currentObject3D)||void 0===m?void 0:m.scale.z),r.a.createElement("br",null),r.a.createElement("b",null,"Object Info in options:")," ",r.a.createElement("br",null),function(){var e=O(),t=(e?JSON.stringify(e,!1,2):"no sel").split("\n"),a=[];return t.forEach((function(e,t){a.push(e),a.push(r.a.createElement("br",{key:"return-"+t}))})),a}())}},33:function(e,t,a){"use strict";var n=a(32),r=a(17),o=a(8),_=a(0),l=a.n(_),c=a(9),s=a(10),i=a(28),u=a(11),p=a(5),d=a(16);function m(e){var t=function(t){var a=t===e.input.deleteIfValue?null:t,n=Object(c.a)({},e.input.option,a);"background"===e.input.option&&""===a&&(n[e.input.option]="transparent"),"sprite"===e.input.option&&!0===a&&(n.scale=10*e.currentObject3D.scale.x),"sprite"!==e.input.option||a||(n.scale=e.currentObject3D.scale.x/10),e.updateObjectSingleData(e.currentObject3D.name,n)};return function(){var a,n;switch(e.input.type){case"image":return l.a.createElement(p.a,null,l.a.createElement(p.a.Prepend,null," ",l.a.createElement(p.a.Text,null,e.input.label)),l.a.createElement(i.FilePicker,{extensions:["jpg","jpeg","png","gif","svg"],dims:{minWidth:100,maxWidth:2500,minHeight:100,maxHeight:2500},onChange:function(t){return e.updateObjectSingleData(e.currentObject3D.name,Object(c.a)({},e.input.option,e.imgPath+t.name))},onError:function(e){return alert(e)}},l.a.createElement(s.a,{variant:"primary"},"Select image")),l.a.createElement(s.a,{variant:"danger",onClick:function(e){t(null)}},"Clear"),l.a.createElement(p.a.Append,null," ",l.a.createElement(p.a.Text,null,e.getOptionsByObject3D(e.currentObject3D,e.input.option))));case"input":return l.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(e.currentTarget.querySelector("input").value)}},l.a.createElement(p.a,null,l.a.createElement(p.a.Prepend,null," ",l.a.createElement(p.a.Text,null,e.input.label)),l.a.createElement(u.a,{as:"input",defaultValue:e.getOptionsByObject3D(e.currentObject3D,e.input.option)}),l.a.createElement(p.a.Append,null,l.a.createElement(p.a.Text,null," ",e.getOptionsByObject3D(e.currentObject3D,e.input.option)," ")," ")));case"number":return l.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(e.currentTarget.querySelector("input").value)}},l.a.createElement(p.a,null,l.a.createElement(p.a.Prepend,null," ",l.a.createElement(p.a.Text,null,e.input.label)),l.a.createElement(d.a.Check,{type:"number",step:null!==(a=e.input.step)&&void 0!==a?a:1,defaultValue:e.getOptionsByObject3D(e.currentObject3D,e.input.option)}),l.a.createElement(p.a.Append,null,l.a.createElement(p.a.Text,null," ",e.getOptionsByObject3D(e.currentObject3D,e.input.option)," ")," ")));case"checkbox":return l.a.createElement(d.a.Group,null,l.a.createElement(d.a.Check,{type:"checkbox",label:e.input.label+"(".concat(e.getOptionsByObject3D(e.currentObject3D,e.input.option),")"),defaultChecked:e.getOptionsByObject3D(e.currentObject3D,e.input.option)===e.input.checkedValue()||e.input.deleteIfValue===e.input.checkedValue(),onChange:function(a){var n=a.currentTarget.checked?e.input.checkedValue(e.currentObject3D):e.input.uncheckedValue(e.currentObject3D);t(n)}}));case"select":return l.a.createElement(p.a,null,l.a.createElement(p.a.Prepend,null," ",l.a.createElement(p.a.Text,null,e.input.label)),l.a.createElement(u.a,{as:"select",defaultValue:e.getOptionsByObject3D(e.currentObject3D,e.input.option),onChange:function(e){return t(e.target.value)}},l.a.createElement("option",{key:"nothing",value:""},"---"),"object"===typeof e.input.options?null===(n=Object.keys(e.input.options))||void 0===n?void 0:n.map((function(t){return l.a.createElement("option",{key:t,value:e.input.options[t]},t)})):null),l.a.createElement(p.a.Append,null,l.a.createElement(p.a.Text,null," ",e.getOptionsByObject3D(e.currentObject3D,e.input.option)," ")," "))}}()}var O=a(12),b=a(20),E=a(19);t.a=function(e){var t=Object(_.useState)("resources/"),a=Object(o.a)(t,2),c=a[0],s=a[1],i=Object(_.createRef)();Object(_.useEffect)((function(){if(window.pl){console.log("pl updated in edit",window.pl);var t=window.pl.viewer;t.renderer.domElement.addEventListener("mousedown",(function(e){d(e)})),t.renderer.domElement.addEventListener("mousemove",(function(t){if(window.selectedObj){var a=e.getMouse3Dposition(t,window.pl);if(a){var o=Object(n.a)(e.globalVars.THREE.Vector3,Object(r.a)(a)).normalize().multiplyScalar(window.selectedObj.distance);a=[o.x,o.y,o.z],window.pl.setObjectPos(window.selectedObj,a)}}})),t.renderer.domElement.addEventListener("mouseup",(function(e){f(e)})),document.addEventListener("keydown",(function(e){D(e)}))}}),[e.plOptions]);var d=function(t){var a;if(e.isEditMode&&!window.pl.shiftIsPressed){var n=window.pl.viewer,r=n.raycaster.intersectObject(n.panorama,!0),o=r[0]?r[0].object:null;(null===(a=o.type)||void 0===a?void 0:a.startsWith("pl_"))&&(o.distance=n.camera.position.distanceTo(o.position),window.selectedObj=o,console.log("Edit Object cLicked",window.selectedObj.name),n.OrbitControls.enabled=!1,window.selectedObj.originalPos=window.selectedObj.position,e.selectObject(o))}},f=function(t){e.isEditMode&&window.selectedObj&&(window.selectedObj.type.startsWith("pl_")&&(window.pl.viewer.OrbitControls.enabled=!0,e.singleObject3DToParams(window.selectedObj),window.selectedObj=null))},D=function(t){if(window.lastSelectedObj&&t.ctrlKey){switch(t.key){case"+":window.lastSelectedObj.scale.set(window.lastSelectedObj.scale.x*e.editParams.SCALE_FACTOR,window.lastSelectedObj.scale.y*e.editParams.SCALE_FACTOR,window.lastSelectedObj.scale.z*e.editParams.SCALE_FACTOR);break;case"-":window.lastSelectedObj.scale.set(window.lastSelectedObj.scale.x/e.editParams.SCALE_FACTOR,window.lastSelectedObj.scale.y/e.editParams.SCALE_FACTOR,window.lastSelectedObj.scale.z/e.editParams.SCALE_FACTOR);break;case"r":window.lastSelectedObj.rotation.z+=e.editParams.ROTATE_DEG;break;case"t":window.lastSelectedObj.rotation.z-=e.editParams.ROTATE_DEG;break;case"f":window.lastSelectedObj.rotation.y+=e.editParams.ROTATE_DEG;break;case"g":window.lastSelectedObj.rotation.y-=e.editParams.ROTATE_DEG;break;case"v":window.lastSelectedObj.rotation.x+=e.editParams.ROTATE_DEG;break;case"b":window.lastSelectedObj.rotation.x-=e.editParams.ROTATE_DEG;break;case"4":P(window.lastSelectedObj,"close");break;case"5":P(window.lastSelectedObj,"far")}"r"!==t.key&&"t"!==t.key&&"f"!==t.key&&"g"!==t.key&&"v"!==t.key&&"b"!==t.key||"Infospot"===window.lastSelectedObj.constructor.name&&e.setInfo("Sprite object cannot be rotated"),e.setCurrentObject3D(window.lastSelectedObj),window.waitSave&&(clearTimeout(window.waitSave),window.waitSave=setTimeout((function(){e.singleObject3DToParams(window.lastSelectedObj),clearTimeout(window.waitSave),e.setInfo("updated")}),500))}};function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"close",a=1.02;"close"===t&&(a=1/a);var n=e.position.clone();n.x*=a,n.y*=a,n.z*=a;var r=window.pl.viewer.camera.position.distanceTo(n);"close"!==t&&r>500||"close"===t&&r<40?console.warn("we cant move that limit. Its out of 40 - 500m"):window.pl.setObjectPos(e,[n.x,n.y,n.z])}var w={};e.plOptions&&e.plOptions.worlds.forEach((function(e){return w[e.name]=e.name}));var j=[[{option:"image",type:"image",label:"Img",active:["pl_poster3d"],deleteIfValue:""},{option:"alpha",type:"image",label:"Alpha",active:["pl_poster3d"],deleteIfValue:""},{option:"text",type:"input",label:"Text",active:["pl_text-2d","pl_text-3d"]},{option:"background",type:"input",label:"bg color (#ffffff)",active:["pl_text-2d"]},{option:"alwaysLookatCamera",type:"checkbox",label:"alwaysLookatCamera",checkedValue:function(){return!0},uncheckedValue:function(){return!1},active:["pl_text-2d","pl_text-3d","pl_poster3d"],deleteIfValue:!0},{option:"sprite",type:"checkbox",label:"sprite",checkedValue:function(){return!0},uncheckedValue:function(){return null},active:["pl_text-2d","pl_poster3d"],deleteIfValue:!1},{option:"link",type:"select",options:w,label:"Go to pano",active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""},{option:"opacity",type:"number",step:.05,label:"Opacity",active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:"1"}],[{option:"animatedMap",type:"number",label:"frames animation map",active:["pl_poster3d"],deleteIfValue:""},{option:"animatedMapSpeed",type:"number",label:"speed",active:["pl_poster3d"],deleteIfValue:""},{option:"rotationX",type:"number",label:"Rotate anim X",step:100,active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""},{option:"rotationY",type:"number",label:"Rotate anim Y",step:100,active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""},{option:"rotationZ",type:"number",label:"Rotate anim Z",step:100,active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""},{option:"animated",type:"select",label:"Glow animation",options:{always:"always","only on hover":"hover"},active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""},{option:"popupWhenVisible",type:"number",step:100,label:"Pops up when in camera",active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""}]];return l.a.createElement(E.a,null,e.currentObject3D?l.a.createElement("div",{className:"position-absolute",style:{marginTop:"-30px"}},l.a.createElement("span",{role:"img","aria-label":"c"},"\u2b06\ufe0f"),e.getOptionsByObject3D(e.currentObject3D,"name")," ",l.a.createElement("small",null,e.getOptionsByObject3D(e.currentObject3D,"type")),l.a.createElement("form",{className:"float-left",onSubmit:function(t){t.preventDefault();var a=t.currentTarget.querySelector("input").value;e.updateObjectSingleData(e.currentObject3D.name,{name:a})}},l.a.createElement(u.a,{as:"input",defaultValue:e.getOptionsByObject3D(e.currentObject3D,"name")}))):null,l.a.createElement(p.a,null,l.a.createElement(p.a.Prepend,null," ",l.a.createElement(p.a.Text,null,"imgs path")),l.a.createElement(u.a,{as:"input",defaultValue:c,ref:i,onChange:function(e){return i.current?s(i.current.value):null}}),l.a.createElement(p.a.Append,null,l.a.createElement(p.a.Text,null," ",c," ")," ")),l.a.createElement(b.a,null,j.map((function(t,a){return l.a.createElement(O.a,{sm:"6",key:"column-"+a},t.map((function(t,a){return e.currentObject3D&&t.active.includes(e.currentObject3D.type)?l.a.createElement(m,{input:t,imgPath:c,key:"input-"+a,updateObjectSingleData:e.updateObjectSingleData,currentObject3D:e.currentObject3D,getOptionsByObject3D:e.getOptionsByObject3D}):null})))}))))}},34:function(e,t,a){e.exports=a(45)},39:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(26),_=a.n(o),l=(a(39),a(8));var c=function(e){var t=e.data,a=e.setAppMode,o=Object(n.createRef)();return Object(n.useEffect)((function(){console.log("hello from useEffect in App"),function(e){var t=this;e?e:console.log("data variable not found.");var a=JSON.parse(localStorage.getItem("pl.o"));if(!(e=(null===a||void 0===a?void 0:a.worlds)?a:e))return void console.error("No data loaded. Cant initialize");window.pl=document.querySelector("#posterlens-container").posterlens(e),window.pl.viewer.panorama.addEventListener("load",(function(){console.log("\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89",t)}))}(t)}),[]),r.a.createElement("div",{class:"container"},r.a.createElement("h1",null,"Demo","#edit"===window.location.hash?r.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:function(){return a("edit")}},"Back"):null),r.a.createElement("div",{className:"posterlens-container",id:"posterlens-container",ref:o}))},s=a(27);a(44);function i(e){var t=Object(n.useState)("#edit"===window.location.hash?"edit":"demo"),a=Object(l.a)(t,2),o=a[0],_=a[1];return"edit"===o?r.a.createElement(s.a,{data:e,setAppMode:_}):r.a.createElement(c,{data:e,setAppMode:_})}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));_.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(i,{data:window.data})),document.getElementById("edit-posterlens-react-container")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,a){"use strict";function n(e){var t=e;return"number"===typeof t&&(t=t.toFixed(2)),t}a.d(t,"a",(function(){return n}))}},[[34,1,2]]]);
//# sourceMappingURL=main.0cc91b9d.chunk.js.map