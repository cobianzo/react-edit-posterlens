(this["webpackJsonpreact-edit-posterlens"]=this["webpackJsonpreact-edit-posterlens"]||[]).push([[0],{26:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return App}));var _Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_AppDemoPosterlens__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(27),_AppEditPosterlens__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(29),_App_css__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(41),_App_css__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_App_css__WEBPACK_IMPORTED_MODULE_4__),bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(42),bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_5__);function App(){Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){console.log("THREE and PANOLENS: ".concat(window.PANOLENS),window.THREE),window.THREE=eval("THREE"),window.PANOLENS=eval("PANOLENS"),window.stopAllAnimations=window.stopAllAnimations}),[]);var _useState=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)("#edit"===window.location.hash?"edit":"demo"),_useState2=Object(_Users_alvaroblancocobian_Sites_formacion_react_react_posterlens_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState,2),appMode=_useState2[0],setAppMode=_useState2[1],data=window.data;return"edit"===appMode?react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_AppEditPosterlens__WEBPACK_IMPORTED_MODULE_3__.a,{data:data,setAppMode:setAppMode}):react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_AppDemoPosterlens__WEBPACK_IMPORTED_MODULE_2__.a,{data:data,setAppMode:setAppMode})}},27:function(e,t,n){"use strict";var a=n(0),o=n.n(a);t.a=function(e){var t=e.data,n=e.setAppMode,r=Object(a.createRef)();return Object(a.useEffect)((function(){console.log("hello from useEffect in App"),function(e){e?e:console.log("data variable not found.");var t=JSON.parse(localStorage.getItem("pl.o"));if(!(e=(null===t||void 0===t?void 0:t.worlds)?t:e))return void console.error("No data loaded. Cant initialize");window.pl=document.querySelector("#posterlens-container").posterlens(e),window.pl.viewer.panorama.addEventListener("load",(function(e){console.log("\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89",e)})),window.scene=window.pl.viewer.getScene()}(t)}),[]),o.a.createElement("div",{className:"container"},o.a.createElement("h1",{onDoubleClick:function(){return n("edit")}},"Demo","#edit"===window.location.hash?o.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:function(){return n("edit")}},"Back"):null),o.a.createElement("div",{className:"posterlens-container",id:"posterlens-container",ref:r}))}},29:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(8),o=n(15),r=n(19),l=n(7),i=n(0),c=n.n(i),s=n(30),u=n(9),p=n(28),d=n(11),m=n(5),b=n(21);function _(e){var t=function(t){var n=t===e.input.deleteIfValue?null:t,o=Object(a.a)({},e.input.option,n);"background"===e.input.option&&""===n&&(o[e.input.option]="transparent"),"sprite"===e.input.option&&!0===n&&(o.scale=10*e.currentObject3D.scale.x),"sprite"!==e.input.option||n||(o.scale=e.currentObject3D.scale.x/10),e.updateObjectSingleData(e.currentObject3D.name,o)};return function(){var n,o;switch(e.input.type){case"image":return c.a.createElement(m.a,null,c.a.createElement(m.a.Prepend,null," ",c.a.createElement(m.a.Text,null,e.input.label)),c.a.createElement(p.FilePicker,{extensions:["jpg","jpeg","png","gif","svg"],dims:{minWidth:100,maxWidth:2500,minHeight:100,maxHeight:2500},onChange:function(t){return e.updateObjectSingleData(e.currentObject3D.name,Object(a.a)({},e.input.option,e.imgPath+t.name))},onError:function(e){return alert(e)}},c.a.createElement(u.a,{variant:"primary"},"Select image")),c.a.createElement(u.a,{variant:"danger",onClick:function(e){t(null)}},"Clear"),c.a.createElement(m.a.Append,null," ",c.a.createElement(m.a.Text,null,e.getOptionsByObject3D(e.currentObject3D,e.input.option))));case"input":return c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(e.currentTarget.querySelector("input").value)}},c.a.createElement(m.a,null,c.a.createElement(m.a.Prepend,null," ",c.a.createElement(m.a.Text,null,e.input.label)),c.a.createElement(d.a,{as:"input",defaultValue:e.getOptionsByObject3D(e.currentObject3D,e.input.option)}),c.a.createElement(m.a.Append,null,c.a.createElement(m.a.Text,null," ",e.getOptionsByObject3D(e.currentObject3D,e.input.option)," ")," ")));case"number":return c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(e.currentTarget.querySelector("input").value)}},c.a.createElement(m.a,null,c.a.createElement(m.a.Prepend,null," ",c.a.createElement(m.a.Text,null,e.input.label)),c.a.createElement(b.a.Check,{type:"number",step:null!==(n=e.input.step)&&void 0!==n?n:1,defaultValue:e.getOptionsByObject3D(e.currentObject3D,e.input.option)}),c.a.createElement(m.a.Append,null,c.a.createElement(m.a.Text,null," ",e.getOptionsByObject3D(e.currentObject3D,e.input.option)," ")," ")));case"checkbox":return c.a.createElement(b.a.Group,null,c.a.createElement(b.a.Check,{type:"checkbox",label:e.input.label+"(".concat(e.getOptionsByObject3D(e.currentObject3D,e.input.option),")"),defaultChecked:e.getOptionsByObject3D(e.currentObject3D,e.input.option)===e.input.checkedValue()||e.input.deleteIfValue===e.input.checkedValue(),onChange:function(n){var a=n.currentTarget.checked?e.input.checkedValue(e.currentObject3D):e.input.uncheckedValue(e.currentObject3D);t(a)}}));case"select":return c.a.createElement(m.a,null,c.a.createElement(m.a.Prepend,null," ",c.a.createElement(m.a.Text,null,e.input.label)),c.a.createElement(d.a,{as:"select",defaultValue:e.getOptionsByObject3D(e.currentObject3D,e.input.option),onChange:function(e){return t(e.target.value)}},c.a.createElement("option",{key:"nothing",value:""},"---"),"object"===typeof e.input.options?null===(o=Object.keys(e.input.options))||void 0===o?void 0:o.map((function(t){return c.a.createElement("option",{key:t,value:e.input.options[t]},t)})):null),c.a.createElement(m.a.Append,null,c.a.createElement(m.a.Text,null," ",e.getOptionsByObject3D(e.currentObject3D,e.input.option)," ")," "))}}()}var w=n(10),O=n(18),f=n(17);var E=function(e){var t,n=Object(i.useState)(null!==(t=window.plImgPath)&&void 0!==t?t:"resources/"),a=Object(l.a)(n,2),r=a[0],u=a[1],p=Object(i.createRef)();Object(i.useEffect)((function(){if(window.pl){console.log("pl updated in edit",window.pl);var t=window.pl.viewer;t.renderer.domElement.addEventListener("mousedown",(function(e){b(e)})),t.renderer.domElement.addEventListener("mousemove",(function(t){if(window.selectedObj){var n=e.reactGetMouse3Dposition(t,window.pl);if(n){var a=Object(s.a)(window.THREE.Vector3,Object(o.a)(n)).normalize().multiplyScalar(window.selectedObj.distance);n=[a.x,a.y,a.z],window.pl.setObjectPos(window.selectedObj,n)}}})),t.renderer.domElement.addEventListener("mouseup",(function(e){E(e)})),document.addEventListener("keydown",(function(e){v(e)}))}}),[e.plOptions]);var b=function(t){var n;if(e.isEditMode&&!window.pl.shiftIsPressed){var a=window.pl.viewer,o=a.raycaster.intersectObject(a.panorama,!0),r=o[0]?o[0].object:null;(null===(n=r.type)||void 0===n?void 0:n.startsWith("pl_"))&&(r.distance=a.camera.position.distanceTo(r.position),window.selectedObj=r,console.log("Edit Object cLicked",window.selectedObj.name),a.OrbitControls.enabled=!1,window.selectedObj.originalPos=window.selectedObj.position,e.selectObject(r))}},E=function(t){e.isEditMode&&window.selectedObj&&(window.selectedObj.type.startsWith("pl_")&&(window.pl.viewer.OrbitControls.enabled=!0,e.singleObject3DToParams(window.selectedObj),window.selectedObj=null))},v=function(t){if(window.lastSelectedObj&&t.ctrlKey){switch(t.key){case"+":window.lastSelectedObj.scale.set(window.lastSelectedObj.scale.x*e.editParams.SCALE_FACTOR,window.lastSelectedObj.scale.y*e.editParams.SCALE_FACTOR,window.lastSelectedObj.scale.z*e.editParams.SCALE_FACTOR);break;case"-":window.lastSelectedObj.scale.set(window.lastSelectedObj.scale.x/e.editParams.SCALE_FACTOR,window.lastSelectedObj.scale.y/e.editParams.SCALE_FACTOR,window.lastSelectedObj.scale.z/e.editParams.SCALE_FACTOR);break;case"r":window.lastSelectedObj.rotation.z+=e.editParams.ROTATE_DEG;break;case"t":window.lastSelectedObj.rotation.z-=e.editParams.ROTATE_DEG;break;case"f":window.lastSelectedObj.rotation.y+=e.editParams.ROTATE_DEG;break;case"g":window.lastSelectedObj.rotation.y-=e.editParams.ROTATE_DEG;break;case"v":window.lastSelectedObj.rotation.x+=e.editParams.ROTATE_DEG;break;case"b":window.lastSelectedObj.rotation.x-=e.editParams.ROTATE_DEG;break;case"4":j(window.lastSelectedObj,"close");break;case"5":j(window.lastSelectedObj,"far")}"r"!==t.key&&"t"!==t.key&&"f"!==t.key&&"g"!==t.key&&"v"!==t.key&&"b"!==t.key||"Infospot"===window.lastSelectedObj.constructor.name&&e.setInfo("Sprite object cannot be rotated"),e.setCurrentObject3D(window.lastSelectedObj),window.waitSave&&(clearTimeout(window.waitSave),window.waitSave=setTimeout((function(){e.singleObject3DToParams(window.lastSelectedObj),clearTimeout(window.waitSave),e.setInfo("updated")}),500))}};function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"close",n=1.02;"close"===t&&(n=1/n);var a=e.position.clone();a.x*=n,a.y*=n,a.z*=n;var o=window.pl.viewer.camera.position.distanceTo(a);"close"!==t&&o>500||"close"===t&&o<40?console.warn("we cant move that limit. Its out of 40 - 500m"):window.pl.setObjectPos(e,[a.x,a.y,a.z])}var D={};e.plOptions&&e.plOptions.worlds.forEach((function(e){return D[e.name]=e.name}));var y=[[{option:"image",type:"image",label:"Img",active:["pl_poster3d"],deleteIfValue:""},{option:"alpha",type:"image",label:"Alpha",active:["pl_poster3d"],deleteIfValue:""},{option:"text",type:"input",label:"Text",active:["pl_text-2d","pl_text-3d"]},{option:"background",type:"input",label:"bg color (#ffffff)",active:["pl_text-2d"]},{option:"alwaysLookatCamera",type:"checkbox",label:"alwaysLookatCamera",checkedValue:function(){return!0},uncheckedValue:function(){return!1},active:["pl_text-2d","pl_text-3d","pl_poster3d"],deleteIfValue:!0},{option:"sprite",type:"checkbox",label:"sprite 2D",checkedValue:function(){return!0},uncheckedValue:function(){return null},active:["pl_text-2d","pl_poster3d"],deleteIfValue:!1},{option:"posterSphere",type:"checkbox",label:"is sphere",checkedValue:function(){return!0},uncheckedValue:function(){return null},active:["pl_text-2d","pl_poster3d"],deleteIfValue:!1},{option:"link",type:"select",options:D,label:"Go to pano",active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""},{option:"modal",type:"input",label:"modal",active:["pl_poster3d","pl_text-2d","pl_text-3d"],deleteIfValue:""},{option:"opacity",type:"number",step:.05,label:"Opacity",active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:"1"}],[{option:"animatedMap",type:"number",label:"frames animation map",active:["pl_poster3d"],deleteIfValue:""},{option:"animatedMapSpeed",type:"number",label:"speed",active:["pl_poster3d"],deleteIfValue:""},{option:"rotationX",type:"number",label:"Rotate anim X",step:100,active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""},{option:"rotationY",type:"number",label:"Rotate anim Y",step:100,active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""},{option:"rotationZ",type:"number",label:"Rotate anim Z",step:100,active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""},{option:"animated",type:"select",label:"Glow animation",options:{always:"always","only on hover":"hover"},active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""},{option:"popupWhenVisible",type:"number",step:10,label:"Pops up when in camera",active:["pl_text-2d","pl_poster3d","pl_text-3d"],deleteIfValue:""}]];return c.a.createElement(f.a,null,e.currentObject3D?c.a.createElement("div",{className:"position-absolute",style:{marginTop:"-30px"}},c.a.createElement("span",{role:"img","aria-label":"c"},"\u2b06\ufe0f"),e.getOptionsByObject3D(e.currentObject3D,"name")," ",c.a.createElement("small",null,e.getOptionsByObject3D(e.currentObject3D,"type")),c.a.createElement("form",{className:"float-left",onSubmit:function(t){t.preventDefault();var n=t.currentTarget.querySelector("input").value;e.updateObjectSingleData(e.currentObject3D.name,{name:n})}},c.a.createElement(d.a,{as:"input",defaultValue:e.getOptionsByObject3D(e.currentObject3D,"name")}))):null,c.a.createElement(m.a,null,c.a.createElement(m.a.Prepend,null," ",c.a.createElement(m.a.Text,null,"imgs path")),c.a.createElement(d.a,{as:"input",defaultValue:r,ref:p,onChange:function(e){return p.current?u(p.current.value):null}}),c.a.createElement(m.a.Append,null,c.a.createElement(m.a.Text,null," ",r," ")," ")),c.a.createElement(O.a,null,y.map((function(t,n){return c.a.createElement(w.a,{sm:"6",key:"column-"+n},t.map((function(t,n){return e.currentObject3D&&t.active.includes(e.currentObject3D.type)?c.a.createElement(_,{input:t,imgPath:r,key:"input-"+n,updateObjectSingleData:e.updateObjectSingleData,currentObject3D:e.currentObject3D,getOptionsByObject3D:e.getOptionsByObject3D}):null})))}))))};function v(e){var t,n=Object(i.useState)(null),a=Object(l.a)(n,2),o=a[0],r=a[1];Object(i.useEffect)((function(){console.log("\ud83d\udeb4\ud83c\udffc\u200d\u2640\ufe0fHello from ListObjects"),r(e.getCurrentPanoramaParams())}),[e.plOptions]);return c.a.createElement(w.a,{className:"list-objects",sm:"2"},"List Hotposts in Pano Options",o&&(null===(t=e.plOptions)||void 0===t?void 0:t.worlds)?c.a.createElement("ul",null,o.hotspots.map((function(t,n){var a;return c.a.createElement("li",{key:n,onClick:function(){var n=window.pl.getObjectByName(t.name);e.selectObject(n)},className:(null===(a=e.currentObject3D)||void 0===a?void 0:a.name)===t.name?"active":""},t.name," ",c.a.createElement("small",null,t.type))}))):null,c.a.createElement("br",null)," ","Camera: ",window.pl?window.pl.getCameraDirection("lookatPoint").join(", "):null,c.a.createElement("br",null),"Angle: ",window.pl?Math.round(100*window.pl.getCameraDirection("rad"))/100:null,"rad :: ",window.pl?Math.round(window.pl.getCameraDirection("deg")):null,"\xba",c.a.createElement("br",null),"Fov: ",window.pl?window.pl.viewer.camera.fov:null,c.a.createElement("br",null),"MousePos: ",e.editParams.currentMouse3DPosition.join(", "),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("i",null,"panorama.objectsToPopupWhenVisible:")," ",o?window.pl?window.pl.viewer.panorama.objectsToPopupWhenVisible?c.a.createElement("div",null," ",Object.keys(window.pl.viewer.panorama.objectsToPopupWhenVisible).map((function(e){var t=Object(l.a)(window.pl.viewer.panorama.objectsToPopupWhenVisible[e],2),n=t[0],a=t[1];return c.a.createElement("p",{key:e},e," : ",n,"\xba, ",a,"\xba")}))," "):"none":"not loaded":null)}var j=function(e){var t,n=null===(t=window.pl)||void 0===t?void 0:t.viewer,a=Object(i.useState)(!1),o=Object(l.a)(a,2),r=o[0],c=o[1];Object(i.useEffect)((function(){console.log("Hellow from widgets"),window.pl&&e.isEditMode&&(r||(c(!0),"undefined"===typeof window.basePath&&(window.basePath="./"),Array.from(["poster3d","poster3d-sphere","text-3d","text-2d"]).forEach((function(e){n.appendControlItem({id:"edit-controls",style:{backgroundImage:"url("+window.basePath+"resources/widget-"+e+".png)",float:"left"},onTap:function(){var t=s(e),n=t.newObj,a=t.objectData;console.log("Created new obj: ",{newObj:n,objectData:a})},group:"editmode"})}))))}),[e.countResets]);var s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"poster3d",a={name:"new_".concat(t,"_")+Math.floor(1e4*Math.random()),type:t,pos:Object.values(n.camera.getWorldDirection(new window.THREE.Vector3).multiplyScalar(300))};switch(t){case"poster3d":a.image=window.basePath+"resources/poster3.jpg";break;case"poster3d-sphere":a.image=window.basePath+"resources/poster3.jpg",a.type="poster3d",a.posterSphere=!0;break;case"text-2d":a.text="New text";break;case"text-3d":a.type="text-3d",a.fontFamily=window.basePath+"resources/fonts/Century_Gothic_Regular.js",a.text="New text"}window.pl.createNewObjectFromParams(n.panorama,a);var o=window.pl.viewer.panorama.getObjectByName(a.name);e.setCurrentObject3D(o);var r=e.getCurrentPanoramaParams();r.hotspots.push(a);var l=e.plOptionsReplaceWorldParams(r);return e.setPlOptions(l),{newObj:o,params:a}};return null};function D(e){var t=e;return"number"===typeof t&&(t=t.toFixed(2)),t}function y(e){var t,n,a,o,r,l,i,s,u,p,d,m;function b(){if(e.currentObject3D)return e.getCurrentPanoramaParams().hotspots.find((function(t){var n;return t.name===(null===(n=e.currentObject3D)||void 0===n?void 0:n.name)}))}return c.a.createElement("div",{className:"object-info position-absolute"},c.a.createElement("h4",null,null===(t=e.currentObject3D)||void 0===t?void 0:t.name,c.a.createElement("small",null," (",null===(n=e.currentObject3D)||void 0===n?void 0:n.type,")")),"Pos: ",D(null===(a=e.currentObject3D)||void 0===a?void 0:a.position.x)," ",D(null===(o=e.currentObject3D)||void 0===o?void 0:o.position.y)," ",D(null===(r=e.currentObject3D)||void 0===r?void 0:r.position.z),c.a.createElement("br",null),"Rot: x ",D(null===(l=e.currentObject3D)||void 0===l?void 0:l.rotation.x)," / y ",D(null===(i=e.currentObject3D)||void 0===i?void 0:i.rotation.y)," / z ",D(null===(s=e.currentObject3D)||void 0===s?void 0:s.rotation.z),(null===(u=b())||void 0===u?void 0:u.alwaysLookatCamera)?"(alwayslookatcamera)":null,c.a.createElement("br",null),"Scale: ",D(null===(p=e.currentObject3D)||void 0===p?void 0:p.scale.x)," ",D(null===(d=e.currentObject3D)||void 0===d?void 0:d.scale.y)," ",D(null===(m=e.currentObject3D)||void 0===m?void 0:m.scale.z),c.a.createElement("br",null),c.a.createElement("b",null,"Object Info in options:")," ",c.a.createElement("br",null),function(){var e=b(),t=(e?JSON.stringify(e,!1,2):"no sel").split("\n"),n=[];return t.forEach((function(e,t){n.push(e),n.push(c.a.createElement("br",{key:"return-"+t}))})),n}())}function g(e){var t,n,s=e.data,p=e.setAppMode,d=(e.globalVars,Object(i.useState)()),m=Object(l.a)(d,2),b=m[0],_=m[1],g=Object(i.useState)(null),P=Object(l.a)(g,2),h=P[0],S=P[1],T=Object(i.useState)(!1),k=Object(l.a)(T,2),x=k[0],C=k[1],A=Object(i.useState)({POSTERLENS_CONTAINER_ID:"posterlens-container",SCALE_FACTOR:1.01,ROTATE_DEG:.05,currentMouse3DPosition:[0,0,0],AUTO_START_EDIT_MODE:1}),M=Object(l.a)(A,2),I=M[0],R=M[1],N=Object(i.useState)(null!==(t=window.basePath)&&void 0!==t?t:"./"),L=Object(l.a)(N,2),V=(L[0],L[1],Object(i.useState)(0)),B=Object(l.a)(V,2),W=B[0],U=B[1],K=Object(i.useState)(""),q=Object(l.a)(K,2),z=q[0],F=q[1],G=Object(i.createRef)(),H=Object(i.createRef)();Object(i.useEffect)((function(){console.log("hello from useEffect in App"),X(),U(1)}),[]),Object(i.useEffect)((function(){window.pl&&I.AUTO_START_EDIT_MODE&&C(!0)}),[W]),Object(i.useEffect)((function(){""!==z&&setTimeout((function(){return F("")}),2e3)}),[z]),Object(i.useEffect)((function(){h&&localStorage.setItem("lastSelectedObj.name",h.name)}),[h]);var J=function(e){if(window.pl){var t=window.pl.viewer;if(t){var n=t.raycaster.intersectObject(t.panorama,!0);if(!(n.length<=0))for(var a=0;a<n.length;){if("invisibleWorld"===n[a].object.name){var o=n[a].point.clone(),r=t.panorama.getWorldPosition(new window.THREE.Vector3);o.sub(r);var l=[Math.round(o.x.toFixed(2)/2),Math.round(o.y.toFixed(2)/2),Math.round(o.z.toFixed(2)/2)];return R(Object.assign({},I,{currentMouse3DPosition:l})),l}a++}}else console.warn("Cant retrieve mouse pos, not viewer defined")}};function X(){var e={};s?e=s:console.log("data variable not found.");var t=JSON.parse(localStorage.getItem("pl.o"));(e=(null===t||void 0===t?void 0:t.worlds)?t:e)?(window.pl=document.querySelector("#"+I.POSTERLENS_CONTAINER_ID).posterlens(e),_(window.pl.o),window.pl.viewer.panorama.addEventListener("load",(function(){var e=localStorage.getItem("lastSelectedObj.name");if(e){var t=window.pl.getObjectByName(e);t&&S(t)}window.scene=window.pl.viewer.getScene(),x&&window.stopAllAnimations(window.pl.viewer)}))):console.error("No data loaded. Cant initialize")}function Y(){document.querySelector("#"+I.POSTERLENS_CONTAINER_ID).innerHTML="",_(null),C(!1),delete window.pl,X(),U(W+1)}function Z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Q(),a=n.hotspots.find((function(t){return t.name===(null===e||void 0===e?void 0:e.name)}));return a&&t?a[t]:a}function Q(){return b.worlds.find((function(e){return e.name===window.pl.viewer.panorama.name}))}function $(){return b.worlds.findIndex((function(e){return e.name===window.pl.viewer.panorama.name}))}function ee(e){var t=Object.assign({},b);return t.worlds[$()]=Object(r.a)({},e),t}function te(e,t){var n=Q(),a=n.hotspots.findIndex((function(t){return t.name===e}));if(!(a<0)){var r=Object(o.a)(n.hotspots);return r[a]=t,n.hotspots=r,ee(n)}}function ne(e){_(e);var t=JSON.stringify(e,!1,2);return localStorage.setItem("pl.o",t),window.onSavePlOptionsCallback&&window.onSavePlOptionsCallback(e),t}function ae(e){var t=Z(e),n=Object(r.a)({},t);if(t){n.pos=[D(e.position.x),D(e.position.y),D(e.position.z)],n.rot=[D(e.rotation.x),D(e.rotation.y),D(e.rotation.z)],n.scale=D(e.scale.x);var a={opacity:1,animatedMap:1},o={opacity:"material.opacity",type:"type"};switch(e.type){case"pl_text-3d":o.emissive="material.emissive",o.transparent="material.transparent";break;case"pl_text-2d-sprite":case"pl_text-2d":o.color="material.color"}return Object.keys(o).forEach((function(t){var r=o[t].split("."),l=e;r.forEach((function(e){return l=l[e]})),"type"===t&&(l=l.replace("pl_","")),null===l&&n.hasOwnProperty(t)?delete n[t]:a.hasOwnProperty(t)?a[t]!=l&&(n[t]=l):n[t]=l})),ne(te(e.name,n)),n}alert("error: no objectCP")}function oe(e){if(!e)return!1;window.lastSelectedObj=e,S(e)}Object(i.useEffect)((function(){window.pl.viewer.editMode=x}),[x]);return c.a.createElement(c.a.Fragment,null,h?c.a.createElement(y,{currentObject3D:h,getCurrentPanoramaParams:Q}):null,b?c.a.createElement(v,{currentObject3D:h,plOptions:b,selectObject:oe,editParams:I,setCurrentObject3D:S,getCurrentPanoramaParams:Q}):null,c.a.createElement(f.a,{className:"wrapper border pt-2",style:{maxWidth:"1200px"}},b?c.a.createElement(u.a,{className:"btn-sm",onClick:function(e){return Y()}}," RESET ",c.a.createElement("span",{className:"badge"},W)," "):null,x?null:c.a.createElement(u.a,{className:"btn-secondary ml-5 btn-sm",onClick:C(!x)},"Start Edit Mode"),b?c.a.createElement(u.a,{className:"btn btn-danger btn-sm",onClick:function(e){localStorage.setItem("pl.o",null),Y()}},"Clear cache "):null,c.a.createElement(u.a,{className:"btn-secondary ml-5 btn-sm",onClick:function(){return function(){var e=JSON.stringify(b,!1,2),t=document.createElement("textarea");t.textContent=e,t.style.width="100%",t.style.height="500px",window.pl.Modal("Export JSON",t)}()}},"Export"),h?c.a.createElement(u.a,{className:"btn btn-danger btn-sm",onClick:function(){if(h){var e=Q(),t=$(),n=(e.hotspots.findIndex((function(e){return e.name===h.name})),Object(o.a)(e.hotspots)),a=n.findIndex((function(e){return e.name===h.name}));n.splice(a,1);var l=Object(r.a)({},b);l.worlds[t].hotspots=n,ne(l),window.pl.viewer.panorama.remove(h),window.pl.viewer.panorama.remove(window.pl.viewer.scene.getChildByName(h.name)),S(null)}}},"Delete"):null,h?c.a.createElement(u.a,{className:"btn btn-success btn-sm",onClick:function(){if(h){var e=Object.assign({},Z(h)),t=Q();e.name="cloned_"+e.name,e.pos=[e.pos[0],e.pos[1]+50,e.pos[2]],t.hotspots.push(e),ne(ee(t)),Y()}}},"Clone"):null,c.a.createElement(u.a,{variant:"outline-primary btn-sm",onClick:function(e){window.stopAllAnimations(window.pl.viewer),e.target.remove()}},"Stop anim."),c.a.createElement(u.a,{variant:"outline-secondary btn-sm",onClick:function(e){return p("demo")}},"Demo"),c.a.createElement(O.a,{className:"no-gutters"},c.a.createElement(w.a,{sm:12},c.a.createElement("div",{onMouseMove:function(e){J()},ref:H},c.a.createElement("div",{id:I.POSTERLENS_CONTAINER_ID,className:"posterlens-container",ref:G}," "))),x?c.a.createElement(E,{plOptions:b,isEditMode:x,editParams:I,currentObject3D:h,setCurrentObject3D:S,reactGetMouse3Dposition:J,singleObject3DToParams:ae,setInfo:F,updateObjectSingleData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Q(),o=a.hotspots.findIndex((function(t){return t.name===e}));if(!(o<0)){var r=a.hotspots.find((function(t){return t.name===e}));r=Object.assign({},r,t),Object.keys(r).forEach((function(e){return null===r[e]&&delete r[e]}));var l=te(e,r);if(ne(l),n){var i=window.pl.getObjectByName(e);if(e&&window.pl.viewer.panorama&&r){window.pl.viewer.panorama.remove(i),window.pl.createNewObjectFromParams(window.pl.viewer.panorama,r);var c=window.pl.getObjectByName(e);setTimeout((function(){return oe(c)}),500)}else oe(i)}}},getCurrentPanoramaParams:Q,selectObject:oe,getOptionsByObject3D:Z}):null),c.a.createElement("div",{className:"info",style:{color:"red"}},z),x?c.a.createElement(j,(n={plOptions:b,isEditMode:x,setIsEditMode:C,setCurrentObject3D:S},Object(a.a)(n,"plOptions",b),Object(a.a)(n,"singleObject3DToParams",ae),Object(a.a)(n,"refContainer",G),Object(a.a)(n,"key",W),Object(a.a)(n,"restartViewer",Y),Object(a.a)(n,"plOptionsReplaceWorldParams",ee),Object(a.a)(n,"getCurrentPanoramaParams",Q),Object(a.a)(n,"setPlOptions",_),n)):null))}},31:function(e,t,n){e.exports=n(32)},32:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(25),l=n.n(r),i=(n(37),n(26));document.querySelectorAll(".wrapper-posterlens-edit-container").forEach((function(e,t){l.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(i.a,null)),e)}))},37:function(e,t,n){},41:function(e,t,n){}},[[31,1,2]]]);
//# sourceMappingURL=main.9fa3eb1c.chunk.js.map